<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Launch Missions - BlueandCosmos</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      /* Inherited from BlueandCosmos */
      --accent: #0033a0;
      --flag-blue: #002366;
      --highlight: #ff4081;
      --text-white: #ffffff;
      --text-light: #cce0ff;
      --dark-bg: #121212;
      --dark-accent: #001f5b;
      
      /* Launch-specific colors */
      --launch-live: #ff4444;
      --launch-upcoming: #00aa44;
      --launch-delayed: #ffaa00;
      --launch-success: #22cc22;
      --launch-failure: #cc2222;
      --countdown-bg: rgba(0, 51, 160, 0.1);
      --countdown-text: #0033a0;
      --agency-spacex: #005288;
      --agency-nasa: #fc3d21;
      --agency-blue-origin: #232f3e;
    }

    html, body { 
      height: 100%; 
      margin: 0;
      font-family: 'Work Sans', sans-serif;
      background: #fff;
      color: #000;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    body.dark { 
      background-color: var(--dark-bg); 
      color: var(--text-white); 
    }

    main { 
      flex: 1 0 auto; 
    }

    :focus-visible { 
      outline: 2px dashed var(--highlight); 
      outline-offset: 2px; 
    }

    /* Header Styles (Inherited from BlueandCosmos) */
    header {
      background: var(--accent);
      color: var(--text-white);
      padding: 1em 2em;
      display: grid;
      grid-template-columns: auto 1fr auto auto auto;
      align-items: center;
      gap: 1.5em;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .logo-link { 
      display: flex; 
      align-items: center; 
      text-decoration: none; 
      color: inherit; 
    }

    .logo-area { 
      display: flex; 
      align-items: center; 
      gap: 0.4em; 
    }

    .logo-area img { 
      height: 50px; 
      width: 50px; 
      margin: 0; 
      padding: 0; 
      background-color: transparent; 
      display: block; 
    }

    .logo-text { 
      display: flex; 
      flex-direction: column; 
      line-height: 1.2; 
      margin-left: -4px; 
    }

    .logo-text .title { 
      font-size: 1.4em; 
      font-weight: bold; 
      color: #fff; 
      margin: 0; 
    }

    .logo-text .tagline { 
      font-size: 0.85em; 
      color: var(--text-light); 
      margin: 0; 
    }

    .nav-right {
      display: flex; 
      align-items: center; 
      justify-content: flex-end; 
      gap: 1.2em;
    }

    .nav-right > * { 
      display: inline-flex; 
      align-items: center; 
    }

    /* Moon Widget */
    .moon-widget {
      display: flex; 
      align-items: center; 
      gap: 0.6em; 
      justify-self: center;
      min-width: 220px; 
      user-select: none; 
      text-decoration: none; 
      color: inherit;
    }

    .moon-icon { 
      width: 28px; 
      height: 28px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 24px; 
      flex-shrink: 0; 
    }

    .moon-info { 
      display: flex; 
      flex-direction: column; 
      gap: 0.1em; 
    }

    .moon-label { 
      color: var(--text-light); 
      font-size: 0.95em; 
      white-space: nowrap; 
      font-weight: 500; 
    }

    .moon-context { 
      color: var(--text-light); 
      font-size: 0.75em; 
      opacity: 0.8; 
      white-space: nowrap; 
    }

    body.dark .moon-label, 
    body.dark .moon-context { 
      color: #e0ecff; 
    }

    @media (max-width: 900px) { 
      .moon-widget { 
        display: none; 
      } 
    }

    /* Mars Widget */
    .mars-widget {
      display: flex; 
      align-items: center; 
      gap: 0.6em; 
      justify-self: center;
      user-select: none; 
      text-decoration: none; 
      color: inherit;
      transition: transform 0.2s ease;
    }

    .mars-label {
      color: var(--text-light); 
      font-size: 0.95em; 
      font-weight: 600; 
      white-space: nowrap;
    }

    body.dark .mars-label { 
      color: #e0ecff; 
    }

    .mars-widget:hover { 
      transform: scale(1.05); 
    }

    .mars-icon { 
      width: 32px; 
      height: 32px; 
      border-radius: 50%; 
      background-image: url('https://photojournal.jpl.nasa.gov/jpeg/PIA00407.jpg');
      background-size: cover;
      background-position: center;
      display: flex; 
      align-items: center; 
      justify-content: center; 
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(205, 92, 92, 0.4);
      border: 2px solid rgba(205, 92, 92, 0.3);
    }

    @media (max-width: 1100px) { 
      .mars-widget { 
        display: none; 
      } 
    }

    /* Navigation Styles */
    nav { 
      display: contents; 
    }

    .dropdown { 
      position: relative; 
    }

    .dropbtn {
      background: none; 
      border: none; 
      font-size: 1em; 
      color: #fff;
      cursor: pointer; 
      padding: 0.4em 0; 
      position: relative;
      text-decoration: none; 
      display: inline-block;
    }

    .dropbtn:hover, 
    .dropbtn:focus { 
      color: var(--highlight); 
    }

    .dropbtn::after {
      content: ""; 
      position: absolute; 
      left: 0; 
      bottom: -2px;
      width: 0; 
      height: 2px; 
      background: var(--highlight);
      transition: width 0.25s ease-in-out;
    }

    .dropdown:hover > .dropbtn::after,
    .dropbtn:focus::after,
    .dropdown.open > .dropbtn::after { 
      width: 100%; 
    }

    .dropdown-content {
      display: none; 
      position: absolute; 
      top: calc(100% + 0.6em); 
      left: 0;
      background: var(--accent); 
      min-width: 220px;
      flex-direction: column; 
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      z-index: 1001; 
      padding: 0.3em 0; 
      border-radius: 6px;
    }

    .dropdown:hover .dropdown-content,
    .dropdown:focus-within .dropdown-content,
    .dropdown.open .dropdown-content { 
      display: flex; 
    }

    .dropdown-content a {
      color: var(--text-light); 
      text-decoration: none;
      padding: 0.8em 1em; 
      position: relative;
      transition: color 0.2s ease, background-color 0.2s ease, transform 0.15s ease;
    }

    .dropdown-content a:hover,
    .dropdown-content a:focus,
    .dropdown-content a.clicked {
      background-color: var(--flag-blue); 
      color: #fff !important; 
      transform: translateX(5px);
    }

    .dropdown-content a::after {
      content: ""; 
      position: absolute; 
      left: 1em; 
      bottom: 6px;
      width: 0; 
      height: 2px; 
      background: var(--highlight);
      transition: width 0.25s ease;
    }

    .dropdown-content a:hover::after,
    .dropdown-content a:focus::after,
    .dropdown-content a.clicked::after { 
      width: calc(100% - 2em); 
    }

    body.dark .dropdown-content a { 
      color: #d9e6ff; 
    }

    .nav-link { 
      color: #fff; 
      text-decoration: none; 
      position: relative; 
      padding-bottom: 2px; 
    }

    .nav-link:hover { 
      color: var(--highlight); 
    }

    .nav-link::after {
      content: ""; 
      position: absolute; 
      left: 0; 
      bottom: -2px;
      width: 0; 
      height: 2px; 
      background: var(--highlight);
      transition: width 0.25s ease-in-out;
    }

    .nav-link:hover::after { 
      width: 100%; 
    }

    .toggle-theme { 
      cursor: pointer; 
      font-size: 1.5em; 
      line-height: 1; 
      user-select: none; 
    }

    body.dark header, 
    body.dark footer { 
      background-color: var(--dark-accent); 
    }

    body.dark .dropbtn, 
    body.dark .nav-link { 
      color: #e6f0ff; 
    }

    /* Launch Dashboard Styles */
    .launch-dashboard {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2em;
      min-height: calc(100vh - 200px);
    }

    .dashboard-header {
      text-align: center;
      margin-bottom: 3em;
      padding: 2em;
      background: linear-gradient(135deg, var(--accent) 0%, var(--flag-blue) 100%);
      border-radius: 20px;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .dashboard-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="1" fill="white" opacity="0.3"/><circle cx="80" cy="40" r="0.5" fill="white" opacity="0.4"/><circle cx="40" cy="80" r="1.5" fill="white" opacity="0.2"/><circle cx="90" cy="90" r="0.8" fill="white" opacity="0.3"/></svg>');
      animation: twinkle 8s linear infinite;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.8; }
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideOutRight {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }

    .live-indicator {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
      margin-bottom: 1em;
      position: relative;
      z-index: 1;
    }

    .status-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--launch-live);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }

    .status-text {
      font-weight: 600;
      font-size: 1.1em;
    }

    .next-launch-preview {
      position: relative;
      z-index: 1;
    }

    .next-mission-name {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 0.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .next-countdown {
      display: flex;
      justify-content: center;
      gap: 1em;
      margin-top: 1em;
    }

    .time-unit {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(255, 255, 255, 0.1);
      padding: 1em;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      min-width: 80px;
    }

    .time-unit .number {
      font-size: 2.5em;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      line-height: 1;
    }

    .time-unit .label {
      font-size: 0.9em;
      opacity: 0.8;
      margin-top: 0.2em;
    }

    /* Controls Bar */
    .controls-bar {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 1.5em;
      margin-bottom: 2em;
      padding: 1.5em;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    body.dark .controls-bar {
      background: rgba(0, 0, 0, 0.2);
      border-color: rgba(255, 255, 255, 0.05);
    }

    .filter-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.8em;
    }

    .filter-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(0, 51, 160, 0.3);
      color: var(--accent);
      padding: 0.6em 1.2em;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9em;
      font-weight: 500;
      white-space: nowrap;
    }

    .filter-btn:hover {
      background: rgba(0, 51, 160, 0.1);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .filter-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0, 51, 160, 0.3);
    }

    body.dark .filter-btn {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      border-color: rgba(255, 255, 255, 0.2);
    }

    body.dark .filter-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: var(--text-light);
    }

    body.dark .filter-btn.active {
      background: var(--dark-accent);
      color: white;
      border-color: var(--dark-accent);
    }

    .view-controls {
      display: flex;
      gap: 0.5em;
    }

    .view-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(0, 51, 160, 0.3);
      color: var(--accent);
      padding: 0.6em 1em;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9em;
      font-weight: 500;
    }

    .view-btn:hover {
      background: rgba(0, 51, 160, 0.1);
      border-color: var(--accent);
    }

    .view-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    body.dark .view-btn {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      border-color: rgba(255, 255, 255, 0.2);
    }

    body.dark .view-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: var(--text-light);
    }

    body.dark .view-btn.active {
      background: var(--dark-accent);
      color: white;
      border-color: var(--dark-accent);
    }

    .search-controls {
      display: flex;
      gap: 0.5em;
      align-items: center;
    }

    .search-input {
      padding: 0.6em 1em;
      border: 1px solid rgba(0, 51, 160, 0.3);
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--accent);
      font-size: 0.9em;
      min-width: 250px;
      backdrop-filter: blur(10px);
    }

    .search-input::placeholder {
      color: rgba(0, 51, 160, 0.6);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 0 3px rgba(0, 51, 160, 0.1);
    }

    body.dark .search-input {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      border-color: rgba(255, 255, 255, 0.2);
    }

    body.dark .search-input::placeholder {
      color: rgba(255, 255, 255, 0.4);
    }

    body.dark .search-input:focus {
      border-color: var(--text-light);
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
    }

    .search-btn {
      background: var(--accent);
      border: none;
      color: white;
      padding: 0.6em;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .search-btn:hover {
      background: var(--flag-blue);
      transform: scale(1.1);
    }

    body.dark .search-btn {
      background: var(--dark-accent);
    }

    body.dark .search-btn:hover {
      background: var(--accent);
    }

    /* Launch Grid Layout */
    .launch-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
      gap: 2em;
      margin-bottom: 3em;
    }

    /* Launch Card Component */
    .launch-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 1.5em;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .launch-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 51, 160, 0.2);
      border-color: rgba(0, 51, 160, 0.3);
    }

    body.dark .launch-card {
      background: rgba(0, 0, 0, 0.2);
      border-color: rgba(255, 255, 255, 0.05);
    }

    body.dark .launch-card:hover {
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .launch-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1em;
    }

    .agency-badge {
      display: flex;
      align-items: center;
      gap: 0.5em;
      padding: 0.4em 0.8em;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }

    .agency-logo {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      object-fit: cover;
    }

    .agency-name {
      font-size: 0.9em;
      font-weight: 600;
      color: var(--text-white);
    }

    body.dark .agency-name {
      color: var(--text-light);
    }

    /* Agency-specific styling */
    .agency-badge.spacex {
      background: linear-gradient(135deg, var(--agency-spacex), #007bb8);
    }

    .agency-badge.nasa {
      background: linear-gradient(135deg, var(--agency-nasa), #ff6b47);
    }

    .agency-badge.blue-origin {
      background: linear-gradient(135deg, var(--agency-blue-origin), #4a5568);
    }

    .agency-badge.esa {
      background: linear-gradient(135deg, #1e3a8a, #3b82f6);
    }

    .agency-badge.international {
      background: linear-gradient(135deg, #059669, #10b981);
    }

    .agency-badge.isro {
      background: linear-gradient(135deg, #ff6600, #ff8533);
    }

    .agency-badge.cnsa {
      background: linear-gradient(135deg, #dc2626, #ef4444);
    }

    .agency-badge.roscosmos {
      background: linear-gradient(135deg, #1e40af, #3b82f6);
    }

    .agency-badge.jaxa {
      background: linear-gradient(135deg, #7c2d12, #dc2626);
    }

    .agency-badge.csa {
      background: linear-gradient(135deg, #dc2626, #ffffff);
    }

    .launch-status {
      padding: 0.3em 0.8em;
      border-radius: 15px;
      font-size: 0.8em;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-upcoming {
      background: var(--launch-upcoming);
      color: white;
      animation: pulse 2s infinite;
    }

    .status-live {
      background: var(--launch-live);
      color: white;
      animation: pulse 1s infinite;
    }

    .status-delayed {
      background: var(--launch-delayed);
      color: white;
    }

    .status-success {
      background: var(--launch-success);
      color: white;
    }

    .status-failure {
      background: var(--launch-failure);
      color: white;
    }

    .mission-info {
      margin-bottom: 1.5em;
    }

    .mission-name {
      font-size: 1.4em;
      font-weight: bold;
      margin-bottom: 0.5em;
      color: var(--accent);
      line-height: 1.3;
    }

    body.dark .mission-name {
      color: var(--text-light);
    }

    .mission-description {
      color: var(--text-light);
      font-size: 0.95em;
      line-height: 1.5;
      margin-bottom: 1em;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    body.dark .mission-description {
      color: #cce0ff;
    }

    .launch-details {
      display: grid;
      gap: 0.5em;
      margin-bottom: 1.5em;
    }

    .detail-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.3em 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .detail-item:last-child {
      border-bottom: none;
    }

    .detail-label {
      font-size: 0.85em;
      color: var(--text-light);
      font-weight: 500;
    }

    .detail-value {
      font-size: 0.85em;
      color: var(--accent);
      font-weight: 600;
      text-align: right;
    }

    body.dark .detail-label {
      color: #cce0ff;
    }

    body.dark .detail-value {
      color: var(--text-light);
    }

    .countdown-section {
      margin: 1.5em 0;
      padding: 1em;
      background: var(--countdown-bg);
      border-radius: 12px;
      border: 1px solid rgba(0, 51, 160, 0.2);
    }

    body.dark .countdown-section {
      background: rgba(0, 51, 160, 0.15);
      border-color: rgba(0, 51, 160, 0.3);
    }

    .countdown-timer {
      text-align: center;
    }

    .countdown-display {
      display: flex;
      justify-content: center;
      gap: 0.8em;
      margin-bottom: 0.8em;
    }

    .countdown-display .time-unit {
      background: rgba(255, 255, 255, 0.1);
      padding: 0.8em 0.6em;
      border-radius: 8px;
      min-width: 60px;
      backdrop-filter: blur(10px);
    }

    .countdown-display .time-unit .number {
      font-size: 1.8em;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      line-height: 1;
      color: var(--countdown-text);
    }

    .countdown-display .time-unit .label {
      font-size: 0.7em;
      opacity: 0.8;
      margin-top: 0.2em;
      color: var(--text-light);
    }

    body.dark .countdown-display .time-unit .number {
      color: var(--text-light);
    }

    body.dark .countdown-display .time-unit .label {
      color: #cce0ff;
    }

    .countdown-progress {
      width: 100%;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--launch-upcoming), var(--accent));
      border-radius: 2px;
      transition: width 0.3s ease;
    }

    .launch-actions {
      display: flex;
      gap: 0.8em;
      margin-top: 1.5em;
    }

    .action-btn {
      flex: 1;
      padding: 0.8em 1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 600;
      transition: all 0.3s ease;
      text-decoration: none;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.3em;
    }

    .action-btn.primary {
      background: var(--accent);
      color: white;
    }

    .action-btn.primary:hover {
      background: var(--flag-blue);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 51, 160, 0.3);
    }

    .action-btn.secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--accent);
      border: 1px solid rgba(0, 51, 160, 0.3);
    }

    .action-btn.secondary:hover {
      background: rgba(0, 51, 160, 0.1);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    body.dark .action-btn.primary {
      background: var(--dark-accent);
    }

    body.dark .action-btn.primary:hover {
      background: var(--accent);
    }

    body.dark .action-btn.secondary {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      border-color: rgba(255, 255, 255, 0.2);
    }

    body.dark .action-btn.secondary:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: var(--text-light);
    }

    /* Countdown Urgency Levels */
    .urgency-normal .countdown-section {
      border-color: rgba(0, 51, 160, 0.2);
      background: var(--countdown-bg);
    }

    .urgency-warning .countdown-section {
      border-color: rgba(255, 170, 0, 0.4);
      background: rgba(255, 170, 0, 0.1);
      animation: warningPulse 3s infinite;
    }

    .urgency-critical .countdown-section {
      border-color: rgba(255, 68, 68, 0.6);
      background: rgba(255, 68, 68, 0.15);
      animation: criticalPulse 1s infinite;
    }

    @keyframes warningPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(255, 170, 0, 0.4); }
      50% { box-shadow: 0 0 0 8px rgba(255, 170, 0, 0.1); }
    }

    @keyframes criticalPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.6); }
      50% { box-shadow: 0 0 0 12px rgba(255, 68, 68, 0.2); }
    }

    /* Enhanced countdown number animations */
    .countdown-display .time-unit .number {
      transition: all 0.2s ease;
      position: relative;
    }

    .countdown-display .time-unit .number:hover {
      transform: scale(1.05);
    }

    /* Urgency-based card styling */
    .urgency-warning {
      border-color: rgba(255, 170, 0, 0.3);
    }

    .urgency-critical {
      border-color: rgba(255, 68, 68, 0.4);
      animation: cardCriticalPulse 2s infinite;
    }

    @keyframes cardCriticalPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    /* Precision indicators */
    .countdown-timer[data-precision="approximate"]::after {
      content: "~";
      position: absolute;
      top: -5px;
      right: -5px;
      font-size: 0.8em;
      color: var(--launch-delayed);
    }

    .countdown-timer[data-precision="tbd"]::after {
      content: "TBD";
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 0.6em;
      background: var(--launch-delayed);
      color: white;
      padding: 0.2em 0.4em;
      border-radius: 4px;
    }

    /* Live countdown special styling */
    .status-live + * .countdown-display .time-unit {
      background: linear-gradient(135deg, rgba(255, 68, 68, 0.2), rgba(255, 68, 68, 0.1));
      border: 1px solid rgba(255, 68, 68, 0.3);
    }

    .status-live + * .countdown-display .time-unit .number {
      color: var(--launch-live);
      font-weight: bold;
      animation: liveNumberPulse 1s infinite;
    }

    @keyframes liveNumberPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* Milestone notification styling */
    .milestone-notification {
      position: fixed;
      top: 140px;
      right: 20px;
      background: var(--launch-live);
      color: white;
      padding: 1em 1.5em;
      border-radius: 8px;
      font-size: 0.9em;
      font-weight: bold;
      z-index: 10002;
      animation: slideInRight 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 68, 68, 0.3);
    }

    /* Loading Skeleton Animations */
    .loading-skeleton {
      background: linear-gradient(90deg, 
        rgba(0, 51, 160, 0.1) 25%, 
        rgba(0, 51, 160, 0.2) 50%, 
        rgba(0, 51, 160, 0.1) 75%
      );
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: 12px;
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    .skeleton-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 1.5em;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }

    body.dark .skeleton-card {
      background: rgba(0, 0, 0, 0.2);
      border-color: rgba(255, 255, 255, 0.05);
    }

    .skeleton-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1em;
    }

    .skeleton-agency {
      width: 120px;
      height: 24px;
    }

    .skeleton-status {
      width: 80px;
      height: 20px;
    }

    .skeleton-mission-name {
      width: 70%;
      height: 28px;
      margin-bottom: 0.8em;
    }

    .skeleton-description {
      width: 100%;
      height: 16px;
      margin-bottom: 0.5em;
    }

    .skeleton-description:last-of-type {
      width: 80%;
    }

    .skeleton-details {
      margin: 1.5em 0;
    }

    .skeleton-detail {
      width: 60%;
      height: 14px;
      margin-bottom: 0.5em;
    }

    .skeleton-countdown {
      display: flex;
      justify-content: space-between;
      gap: 0.5em;
      margin: 1.5em 0;
    }

    .skeleton-time-unit {
      flex: 1;
      height: 60px;
      border-radius: 8px;
    }

    .skeleton-actions {
      display: flex;
      gap: 0.8em;
      margin-top: 1.5em;
    }

    .skeleton-action {
      flex: 1;
      height: 36px;
      border-radius: 8px;
    }

    /* Enhanced Dashboard Header */
    .dashboard-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5em;
      margin-top: 2em;
      position: relative;
      z-index: 1;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 1.5em;
      border-radius: 12px;
      text-align: center;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .stat-number {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 0.2em;
      font-family: 'Courier New', monospace;
    }

    .stat-label {
      font-size: 0.9em;
      opacity: 0.8;
    }

    .stat-change {
      font-size: 0.8em;
      margin-top: 0.3em;
    }

    .stat-change.positive {
      color: var(--launch-success);
    }

    .stat-change.negative {
      color: var(--launch-failure);
    }

    .stat-change.neutral {
      color: rgba(255, 255, 255, 0.6);
    }

    /* Placeholder Content (Updated) */
    .placeholder-content {
      text-align: center;
      padding: 3em 2em;
      background: rgba(0, 51, 160, 0.05);
      border-radius: 16px;
      border: 2px dashed var(--accent);
      margin: 2em 0;
    }

    .placeholder-content h2 {
      color: var(--accent);
      font-size: 1.8em;
      margin-bottom: 1em;
    }

    .placeholder-content p {
      color: var(--text-light);
      font-size: 1em;
      max-width: 600px;
      margin: 0 auto 1.5em;
      line-height: 1.6;
    }

    body.dark .placeholder-content {
      background: rgba(0, 51, 160, 0.1);
      border-color: var(--dark-accent);
    }

    body.dark .placeholder-content h2 {
      color: var(--text-light);
    }

    body.dark .placeholder-content p {
      color: #cce0ff;
    }

    /* Footer Styles */
    footer {
      background-color: var(--accent);
      color: #fff;
      padding: 2em 1em;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      text-align: center;
      gap: 1em;
      margin-top: auto;
    }

    footer a { 
      color: #fff; 
      text-decoration: none; 
    }

    footer a:hover { 
      text-decoration: underline; 
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .launch-grid {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 1.5em;
      }

      .dashboard-stats {
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1em;
      }
    }

    @media (max-width: 900px) {
      .controls-bar {
        flex-direction: column;
        align-items: stretch;
        gap: 1em;
      }

      .filter-controls {
        justify-content: center;
      }

      .view-controls {
        justify-content: center;
      }

      .search-controls {
        justify-content: center;
      }

      .search-input {
        min-width: 200px;
      }

      .launch-grid {
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      }
    }

    @media (max-width: 768px) {
      .launch-dashboard {
        padding: 1em;
      }

      .dashboard-header {
        padding: 1.5em;
        margin-bottom: 2em;
      }

      .next-mission-name {
        font-size: 1.8em;
      }

      .next-countdown {
        gap: 0.5em;
      }

      .time-unit {
        padding: 0.8em;
        min-width: 60px;
      }

      .time-unit .number {
        font-size: 1.8em;
      }

      .time-unit .label {
        font-size: 0.8em;
      }

      .dashboard-stats {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }

      .stat-number {
        font-size: 2em;
      }

      header {
        grid-template-columns: auto 1fr auto;
        gap: 1em;
      }

      .nav-right {
        gap: 0.8em;
      }

      .launch-grid {
        grid-template-columns: 1fr;
        gap: 1.5em;
      }

      .filter-controls {
        gap: 0.5em;
      }

      .filter-btn {
        padding: 0.5em 1em;
        font-size: 0.85em;
      }
    }

    @media (max-width: 480px) {
      .launch-dashboard {
        padding: 0.5em;
      }

      .dashboard-header {
        padding: 1em;
        margin-bottom: 1.5em;
      }

      .next-mission-name {
        font-size: 1.5em;
      }

      .next-countdown {
        gap: 0.3em;
      }

      .time-unit {
        padding: 0.6em;
        min-width: 50px;
      }

      .time-unit .number {
        font-size: 1.5em;
      }

      .time-unit .label {
        font-size: 0.7em;
      }

      .controls-bar {
        padding: 1em;
      }

      .search-input {
        min-width: 150px;
        font-size: 0.85em;
      }

      .filter-controls {
        flex-wrap: wrap;
      }

      .filter-btn {
        padding: 0.4em 0.8em;
        font-size: 0.8em;
      }

      .dashboard-stats {
        grid-template-columns: 1fr 1fr;
        gap: 0.8em;
      }

      .stat-card {
        padding: 1em;
      }

      .stat-number {
        font-size: 1.8em;
      }

      .stat-label {
        font-size: 0.8em;
      }
    }

    /* Advanced Filtering Styles */
    .sort-controls {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }

    .sort-select {
      padding: 0.6em 1em;
      border: 1px solid rgba(0, 51, 160, 0.3);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--accent);
      font-size: 0.9em;
      backdrop-filter: blur(10px);
      cursor: pointer;
    }

    .sort-select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0, 51, 160, 0.1);
    }

    body.dark .sort-select {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      border-color: rgba(255, 255, 255, 0.2);
    }

    body.dark .sort-select:focus {
      border-color: var(--text-light);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
    }

    .filter-stats {
      background: rgba(0, 51, 160, 0.1);
      color: var(--accent);
      padding: 0.4em 0.8em;
      border-radius: 15px;
      font-size: 0.8em;
      font-weight: 600;
      white-space: nowrap;
    }

    body.dark .filter-stats {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-light);
    }

    /* Pagination Styles */
    .pagination-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5em;
      margin: 2em 0;
      padding: 1em;
    }

    .pagination-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(0, 51, 160, 0.3);
      color: var(--accent);
      padding: 0.6em 1em;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 500;
      transition: all 0.3s ease;
      min-width: 40px;
    }

    .pagination-btn:hover:not(:disabled) {
      background: rgba(0, 51, 160, 0.1);
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .pagination-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .pagination-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    body.dark .pagination-btn {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-light);
      border-color: rgba(255, 255, 255, 0.2);
    }

    body.dark .pagination-btn:hover:not(:disabled) {
      background: rgba(255, 255, 255, 0.1);
      border-color: var(--text-light);
    }

    body.dark .pagination-btn.active {
      background: var(--dark-accent);
      color: white;
      border-color: var(--dark-accent);
    }

    /* Filter Animation Enhancements */
    .launch-card {
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .launch-card.filtering {
      opacity: 0.5;
      transform: scale(0.95);
    }

    /* Advanced Search Highlighting */
    .search-highlight {
      background: rgba(255, 64, 129, 0.2);
      padding: 0.1em 0.2em;
      border-radius: 3px;
    }

    /* Filter Clear Button */
    .filter-clear-btn {
      background: var(--launch-delayed);
      color: white;
      border: none;
      padding: 0.6em 1em;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .filter-clear-btn:hover {
      background: var(--launch-failure);
      transform: translateY(-2px);
    }

    /* Responsive Filter Adjustments */
    @media (max-width: 900px) {
      .sort-controls {
        order: 3;
        width: 100%;
        justify-content: center;
      }

      .filter-stats {
        order: 4;
        text-align: center;
      }

      .pagination-controls {
        flex-wrap: wrap;
        gap: 0.3em;
      }

      .pagination-btn {
        padding: 0.5em 0.8em;
        font-size: 0.8em;
        min-width: 35px;
      }
    }

    @media (max-width: 480px) {
      .sort-select {
        width: 100%;
        font-size: 0.85em;
      }

      .filter-stats {
        font-size: 0.75em;
      }

      .pagination-controls {
        margin: 1.5em 0;
      }
    }

    /* Mission Detail Modal Styles */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 10000;
      animation: fadeIn 0.3s ease;
    }

    .modal-overlay.visible {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2em;
    }

    .modal-content {
      background: white;
      border-radius: 20px;
      max-width: 1000px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      animation: slideInUp 0.3s ease;
    }

    .modal-content.large {
      max-width: 1200px;
    }

    body.dark .modal-content {
      background: var(--dark-bg);
      color: var(--text-white);
    }

    .modal-close {
      position: absolute;
      top: 1em;
      right: 1em;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: var(--accent);
      font-size: 2em;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 10001;
    }

    .modal-close:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }

    body.dark .modal-close {
      color: var(--text-light);
      background: rgba(0, 0, 0, 0.3);
    }

    body.dark .modal-close:hover {
      background: rgba(0, 0, 0, 0.5);
    }

    .modal-header {
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 2em;
      padding: 2em;
      background: linear-gradient(135deg, var(--accent), var(--flag-blue));
      color: white;
      border-radius: 20px 20px 0 0;
      position: relative;
      overflow: hidden;
    }

    .modal-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="1" fill="white" opacity="0.2"/><circle cx="80" cy="40" r="0.5" fill="white" opacity="0.3"/><circle cx="40" cy="80" r="1.5" fill="white" opacity="0.1"/></svg>');
      animation: twinkle 10s linear infinite;
    }

    .mission-patch {
      position: relative;
      z-index: 1;
    }

    .mission-patch img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid rgba(255, 255, 255, 0.3);
      object-fit: cover;
    }

    .mission-title-section {
      position: relative;
      z-index: 1;
    }

    .modal-mission-name {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 0.3em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .modal-mission-subtitle {
      font-size: 1.2em;
      opacity: 0.9;
      margin-bottom: 1em;
    }

    .modal-agency-info {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }

    .modal-agency-logo {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      filter: invert(1);
    }

    .modal-agency-name {
      font-size: 1.1em;
      font-weight: 600;
    }

    .modal-countdown-section {
      position: relative;
      z-index: 1;
      text-align: center;
    }

    .modal-countdown {
      display: flex;
      gap: 0.5em;
      justify-content: center;
    }

    .modal-countdown .time-unit {
      background: rgba(255, 255, 255, 0.1);
      padding: 0.8em 0.6em;
      border-radius: 8px;
      min-width: 60px;
      backdrop-filter: blur(10px);
    }

    .modal-countdown .time-unit .number {
      font-size: 1.5em;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      line-height: 1;
    }

    .modal-countdown .time-unit .label {
      font-size: 0.7em;
      opacity: 0.8;
      margin-top: 0.2em;
    }

    .modal-body {
      padding: 0;
    }

    .modal-tabs {
      display: flex;
      background: rgba(0, 51, 160, 0.05);
      border-bottom: 1px solid rgba(0, 51, 160, 0.1);
    }

    body.dark .modal-tabs {
      background: rgba(255, 255, 255, 0.05);
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }

    .tab-btn {
      flex: 1;
      background: none;
      border: none;
      padding: 1.2em 1em;
      font-size: 1em;
      font-weight: 600;
      color: var(--accent);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .tab-btn:hover {
      background: rgba(0, 51, 160, 0.1);
    }

    .tab-btn.active {
      background: var(--accent);
      color: white;
    }

    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--highlight);
    }

    body.dark .tab-btn {
      color: var(--text-light);
    }

    body.dark .tab-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    body.dark .tab-btn.active {
      background: var(--dark-accent);
      color: white;
    }

    .tab-content {
      display: none;
      padding: 2em;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    /* Overview Tab Styles */
    .mission-overview {
      display: grid;
      gap: 2em;
    }

    .overview-section h3 {
      color: var(--accent);
      font-size: 1.4em;
      margin-bottom: 1em;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 0.5em;
    }

    body.dark .overview-section h3 {
      color: var(--text-light);
      border-bottom-color: var(--text-light);
    }

    .mission-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5em;
      margin: 2em 0;
    }

    .stat-item {
      text-align: center;
      padding: 1.5em;
      background: rgba(0, 51, 160, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(0, 51, 160, 0.1);
    }

    body.dark .stat-item {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .stat-item .stat-value {
      display: block;
      font-size: 2em;
      font-weight: bold;
      color: var(--accent);
      margin-bottom: 0.3em;
      font-family: 'Courier New', monospace;
    }

    body.dark .stat-item .stat-value {
      color: var(--text-light);
    }

    .stat-item .stat-label {
      font-size: 0.9em;
      color: var(--text-light);
      font-weight: 500;
    }

    body.dark .stat-item .stat-label {
      color: #cce0ff;
    }

    .mission-details-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2em;
      margin-top: 2em;
    }

    .detail-section h4 {
      color: var(--accent);
      font-size: 1.2em;
      margin-bottom: 1em;
    }

    body.dark .detail-section h4 {
      color: var(--text-light);
    }

    .detail-list {
      display: grid;
      gap: 0.8em;
    }

    .detail-list .detail-item {
      display: flex;
      justify-content: space-between;
      padding: 0.8em;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 8px;
      border: 1px solid rgba(0, 51, 160, 0.1);
    }

    body.dark .detail-list .detail-item {
      background: rgba(0, 0, 0, 0.2);
      border-color: rgba(255, 255, 255, 0.1);
    }

    /* Rocket Tab Styles */
    .rocket-specs {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 3em;
    }

    .rocket-visual {
      text-align: center;
      padding: 2em;
      background: rgba(0, 51, 160, 0.05);
      border-radius: 16px;
      border: 2px solid rgba(0, 51, 160, 0.1);
    }

    body.dark .rocket-visual {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .rocket-illustration {
      font-size: 8em;
      margin-bottom: 0.5em;
      filter: drop-shadow(0 4px 8px rgba(0, 51, 160, 0.3));
    }

    .rocket-name {
      font-size: 1.5em;
      font-weight: bold;
      color: var(--accent);
    }

    body.dark .rocket-name {
      color: var(--text-light);
    }

    .specs-table h3 {
      color: var(--accent);
      font-size: 1.4em;
      margin-bottom: 1em;
    }

    body.dark .specs-table h3 {
      color: var(--text-light);
    }

    .specs-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .specs-table td {
      padding: 0.8em;
      border-bottom: 1px solid rgba(0, 51, 160, 0.1);
    }

    .specs-table td:first-child {
      font-weight: 600;
      color: var(--accent);
      width: 40%;
    }

    body.dark .specs-table td {
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }

    body.dark .specs-table td:first-child {
      color: var(--text-light);
    }

    /* Timeline Tab Styles */
    .mission-timeline {
      position: relative;
      padding-left: 2em;
    }

    .timeline-item {
      position: relative;
      padding: 1.5em 0 1.5em 2em;
      border-left: 3px solid rgba(0, 51, 160, 0.2);
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 2em;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: rgba(0, 51, 160, 0.3);
      border: 3px solid white;
    }

    .timeline-item.completed::before {
      background: var(--launch-success);
    }

    .timeline-item.active::before {
      background: var(--launch-live);
      animation: pulse 2s infinite;
    }

    .timeline-item.upcoming::before {
      background: var(--launch-upcoming);
    }

    .timeline-content h4 {
      color: var(--accent);
      font-size: 1.2em;
      margin-bottom: 0.5em;
    }

    body.dark .timeline-content h4 {
      color: var(--text-light);
    }

    .timeline-date {
      font-size: 0.9em;
      color: var(--text-light);
      font-weight: 600;
    }

    body.dark .timeline-date {
      color: #cce0ff;
    }

    /* Media Tab Styles */
    .media-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5em;
    }

    .media-item {
      border-radius: 12px;
      overflow: hidden;
      background: rgba(0, 51, 160, 0.05);
      border: 1px solid rgba(0, 51, 160, 0.1);
      transition: transform 0.3s ease;
    }

    .media-item:hover {
      transform: scale(1.05);
    }

    body.dark .media-item {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .media-item img,
    .media-item video {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .media-placeholder {
      text-align: center;
      padding: 3em;
      color: var(--text-light);
    }

    body.dark .media-placeholder {
      color: #cce0ff;
    }

    /* Modal Footer */
    .modal-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5em 2em;
      background: rgba(0, 51, 160, 0.05);
      border-top: 1px solid rgba(0, 51, 160, 0.1);
      border-radius: 0 0 20px 20px;
    }

    body.dark .modal-footer {
      background: rgba(255, 255, 255, 0.05);
      border-top-color: rgba(255, 255, 255, 0.1);
    }

    .live-countdown {
      display: flex;
      align-items: center;
      gap: 1em;
    }

    .countdown-label {
      font-weight: 600;
      color: var(--accent);
    }

    body.dark .countdown-label {
      color: var(--text-light);
    }

    .countdown-display.compact {
      display: flex;
      gap: 0.5em;
    }

    .countdown-display.compact .time-unit {
      background: rgba(255, 255, 255, 0.1);
      padding: 0.5em 0.4em;
      border-radius: 6px;
      min-width: 45px;
    }

    .countdown-display.compact .time-unit .number {
      font-size: 1.2em;
      font-weight: bold;
      font-family: 'Courier New', monospace;
    }

    .countdown-display.compact .time-unit .label {
      font-size: 0.6em;
      opacity: 0.8;
    }

    .modal-actions {
      display: flex;
      gap: 1em;
    }

    /* Responsive Modal */
    @media (max-width: 900px) {
      .modal-overlay {
        padding: 1em;
      }

      .modal-header {
        grid-template-columns: 1fr;
        text-align: center;
        gap: 1em;
      }

      .modal-mission-name {
        font-size: 2em;
      }

      .rocket-specs {
        grid-template-columns: 1fr;
        gap: 2em;
      }

      .mission-details-grid {
        grid-template-columns: 1fr;
        gap: 1.5em;
      }

      .mission-stats {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }

      .modal-footer {
        flex-direction: column;
        gap: 1em;
        text-align: center;
      }

      .modal-actions {
        justify-content: center;
      }
    }

    @media (max-width: 480px) {
      .modal-content {
        margin: 0.5em;
        border-radius: 16px;
      }

      .modal-header {
        padding: 1.5em;
      }

      .modal-mission-name {
        font-size: 1.6em;
      }

      .tab-content {
        padding: 1.5em;
      }

      .mission-stats {
        grid-template-columns: 1fr 1fr;
        gap: 1em;
      }

      .stat-item {
        padding: 1em;
      }

      .stat-item .stat-value {
        font-size: 1.5em;
      }

      .modal-actions {
        flex-direction: column;
        width: 100%;
      }

      .action-btn {
        width: 100%;
      }
    }

    /* Animation Keyframes */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideInUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    /* Additional Comprehensive Modal Styles */
    .detail-item {
      display: flex;
      justify-content: space-between;
      padding: 0.5em 0;
      border-bottom: 1px solid rgba(0, 51, 160, 0.1);
    }

    body.dark .detail-item {
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }

    .detail-label {
      font-weight: 600;
      color: var(--accent);
    }

    body.dark .detail-label {
      color: var(--text-light);
    }

    .detail-value {
      color: var(--text-dark);
    }

    body.dark .detail-value {
      color: var(--text-white);
    }

    .timeline-item {
      position: relative;
      padding: 1.5em 0 1.5em 3em;
      border-left: 3px solid rgba(0, 51, 160, 0.2);
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 2em;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: var(--accent);
      border: 3px solid white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .timeline-item.completed::before {
      background: var(--launch-success);
    }

    .timeline-item.active::before {
      background: var(--highlight);
      animation: pulse 2s infinite;
    }

    .timeline-content h4 {
      color: var(--accent);
      margin-bottom: 0.5em;
    }

    body.dark .timeline-content h4 {
      color: var(--text-light);
    }

    .timeline-time {
      font-size: 0.9em;
      color: var(--launch-delayed);
      font-weight: 600;
      font-family: 'Courier New', monospace;
    }

    .media-caption {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
      color: white;
      padding: 1em 0.5em 0.5em;
      font-size: 0.8em;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .media-item:hover .media-caption {
      opacity: 1;
    }

    .link-icon {
      font-size: 1.2em;
    }

    .link-title {
      font-weight: 600;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Enhanced Mobile Modal Styles */
    @media (max-width: 768px) {
      .modal-content.large {
        width: 100%;
        height: 100%;
        max-width: none;
        max-height: none;
        border-radius: 0;
      }

      .modal-header {
        grid-template-columns: 1fr;
        text-align: center;
        gap: 1em;
      }

      .modal-mission-name {
        font-size: 1.8em;
      }

      .countdown-display.compact {
        justify-content: center;
      }

      .modal-actions {
        flex-direction: column;
        gap: 0.5em;
      }

      .action-btn {
        width: 100%;
      }

      .overview-grid {
        grid-template-columns: 1fr;
      }

      .rocket-specs {
        grid-template-columns: 1fr;
      }

      .analytics-grid {
        grid-template-columns: 1fr;
      }

      .media-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }

      .link-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <header>
    <a href="index.html" class="logo-link" aria-label="BlueandCosmos Home">
      <div class="logo-area">
        <img src="https://cdn.jsdelivr.net/gh/swetharajan7/blueandcosmos/assets/logo-transparent.png"
          alt="BlueandCosmos Logo" />
        <div class="logo-text">
          <div class="title">BlueandCosmos</div>
          <div class="tagline">Explore the Universe</div>
        </div>
      </div>
    </a>

    <a href="moon.html" class="moon-widget" aria-label="Lunar Intelligence Center">
      <div class="moon-icon"></div>
      <div class="moon-info">
        <div class="moon-label" id="moon-phase">Loading...</div>
        <div class="moon-context" id="moon-context">Lunar Intelligence</div>
      </div>
    </a>

    <a href="mars.html" class="mars-widget" aria-label="Mars Information">
      <div class="mars-icon"></div>
      <div class="mars-label">Mars</div>
    </a>

    <div class="nav-right">
      <!-- About (internal links, same tab) -->
      <div class="dropdown" data-menu="about">
        <button class="dropbtn">About</button>
        <div class="dropdown-content" role="menu" aria-label="About submenu">
          <a href="about.html" role="menuitem">About BlueandCosmos</a>
        </div>
      </div>

      <!-- Livestream (internal placeholders as relative links) -->
      <div class="dropdown" data-menu="livestream">
        <button class="dropbtn">Livestream</button>
        <div class="dropdown-content" role="menu" aria-label="Livestream submenu">
          <a href="livestream-images.html" role="menuitem">Live Stream Images</a>
          <a href="launch-missions.html" role="menuitem" class="clicked">Launch Missions</a>
          <a href="webinars.html" role="menuitem">Webinars</a>
        </div>
      </div>

      <!-- Dashboard (educational tools and features) -->
      <div class="dropdown" data-menu="dashboard">
        <a href="dashboard.html" class="dropbtn">Dashboard</a>
        <div class="dropdown-content" role="menu" aria-label="Dashboard submenu">
          <a href="moon.html" role="menuitem"> Lunar Intelligence Center</a>
          <a href="telescope.html" role="menuitem"> Telescope</a>
        </div>
      </div>

      <span class="toggle-theme" onclick="toggleTheme()" title="Toggle Dark Mode"></span>
    </div>
  </header>

  <main class="launch-dashboard">
    <section class="dashboard-header">
      <div class="live-indicator">
        <span class="status-dot live"></span>
        <span class="status-text">Live Launch Tracking</span>
      </div>
      <div class="next-launch-preview">
        <h1 class="next-mission-name"> Launch Missions</h1>
        <div class="next-countdown" id="next-countdown">
          <span class="time-unit">
            <span class="number">--</span>
            <span class="label">Days</span>
          </span>
          <span class="time-unit">
            <span class="number">--</span>
            <span class="label">Hours</span>
          </span>
          <span class="time-unit">
            <span class="number">--</span>
            <span class="label">Min</span>
          </span>
          <span class="time-unit">
            <span class="number">--</span>
            <span class="label">Sec</span>
          </span>
        </div>
      </div>
    </section>

        <div class="dashboard-stats">
          <div class="stat-card">
            <div class="stat-number">12</div>
            <div class="stat-label">Upcoming Launches</div>
            <div class="stat-change positive">+3 this week</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">94.2%</div>
            <div class="stat-label">Success Rate</div>
            <div class="stat-change positive">+2.1% vs 2023</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">6</div>
            <div class="stat-label">Active Agencies</div>
            <div class="stat-change neutral">Same as last month</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">127</div>
            <div class="stat-label">Total This Year</div>
            <div class="stat-change positive">+18% vs 2023</div>
          </div>
        </div>
      </div>
    </section>

    <section class="controls-bar">
      <div class="filter-controls">
        <button class="filter-btn active" data-filter="all">All Agencies</button>
        <button class="filter-btn" data-filter="spacex">SpaceX</button>
        <button class="filter-btn" data-filter="nasa">NASA</button>
        <button class="filter-btn" data-filter="blue-origin">Blue Origin</button>
        <button class="filter-btn" data-filter="esa">ESA</button>
        <button class="filter-btn" data-filter="international">International</button>
      </div>
      <div class="view-controls">
        <button class="view-btn active" data-view="upcoming">Upcoming</button>
        <button class="view-btn" data-view="live">Live Now</button>
        <button class="view-btn" data-view="recent">Recent</button>
        <button class="view-btn" data-view="statistics">Statistics</button>
      </div>
      <div class="search-controls">
        <input type="text" id="mission-search" placeholder="Search missions, rockets, payloads..." class="search-input">
        <button class="search-btn" title="Search"></button>
        <button class="filter-clear-btn" onclick="window.filterManager?.clearAllFilters()" title="Clear All Filters">Clear</button>
      </div>
    </section>

    <section class="launch-grid" id="launch-grid">
      <!-- Launch Card 1: SpaceX Falcon Heavy -->
      <article class="launch-card" data-agency="spacex" data-status="upcoming" data-launch-id="falcon-heavy-2024-001">
        <div class="launch-header">
          <div class="agency-badge spacex">
            <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/spacex.svg" alt="SpaceX" class="agency-logo" style="filter: invert(1);">
            <span class="agency-name">SpaceX</span>
          </div>
          <div class="launch-status status-upcoming">Upcoming</div>
        </div>
        
        <div class="mission-info">
          <h3 class="mission-name">Falcon Heavy  Europa Clipper</h3>
          <p class="mission-description">NASA's Europa Clipper mission to Jupiter's moon Europa to investigate its subsurface ocean and potential for life. This flagship mission will conduct detailed reconnaissance of Europa's ice shell and underlying ocean.</p>
          
          <div class="launch-details">
            <div class="detail-item">
              <span class="detail-label">Rocket:</span>
              <span class="detail-value">Falcon Heavy</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Site:</span>
              <span class="detail-value">Kennedy Space Center LC-39A</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Window:</span>
              <span class="detail-value">October 14, 2024  12:06 PM EDT</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Payload Mass:</span>
              <span class="detail-value">6,065 kg</span>
            </div>
          </div>
        </div>

        <div class="countdown-section">
          <div class="countdown-timer" data-launch-time="2024-12-25T16:06:00Z" data-precision="exact">
            <div class="countdown-display">
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Days</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Hours</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Min</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Sec</span>
              </span>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="launch-actions">
          <button class="action-btn primary" onclick="openMissionModal(this)">View Details</button>
          <button class="action-btn secondary" onclick="setNotification(this)"> Notify Me</button>
          <button class="action-btn secondary" onclick="shareLaunch(this)"> Share</button>
        </div>
      </article>

      <!-- Launch Card 2: NASA Artemis -->
      <article class="launch-card" data-agency="nasa" data-status="upcoming" data-launch-id="artemis-2-2024">
        <div class="launch-header">
          <div class="agency-badge nasa">
            <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/nasa.svg" alt="NASA" class="agency-logo" style="filter: invert(1);">
            <span class="agency-name">NASA</span>
          </div>
          <div class="launch-status status-upcoming">Upcoming</div>
        </div>
        
        <div class="mission-info">
          <h3 class="mission-name">Artemis II  Lunar Flyby</h3>
          <p class="mission-description">First crewed mission around the Moon since Apollo 17. Four astronauts will fly around the Moon on a 10-day mission to test systems and procedures for future lunar landings.</p>
          
          <div class="launch-details">
            <div class="detail-item">
              <span class="detail-label">Rocket:</span>
              <span class="detail-value">Space Launch System (SLS)</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Site:</span>
              <span class="detail-value">Kennedy Space Center LC-39B</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Window:</span>
              <span class="detail-value">November 2024  TBD</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Crew:</span>
              <span class="detail-value">4 Astronauts</span>
            </div>
          </div>
        </div>

        <div class="countdown-section">
          <div class="countdown-timer" data-launch-time="2025-02-15T15:00:00Z" data-precision="approximate">
            <div class="countdown-display">
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Days</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Hours</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Min</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Sec</span>
              </span>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="launch-actions">
          <button class="action-btn primary" onclick="openMissionModal(this)">View Details</button>
          <button class="action-btn secondary" onclick="setNotification(this)"> Notify Me</button>
          <button class="action-btn secondary" onclick="shareLaunch(this)"> Share</button>
        </div>
      </article>

      <!-- Launch Card 3: Blue Origin New Shepard -->
      <article class="launch-card" data-agency="blue-origin" data-status="live" data-launch-id="new-shepard-ns-27">
        <div class="launch-header">
          <div class="agency-badge blue-origin">
            <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/blueorigin.svg" alt="Blue Origin" class="agency-logo" style="filter: invert(1);">
            <span class="agency-name">Blue Origin</span>
          </div>
          <div class="launch-status status-live">Live Now</div>
        </div>
        
        <div class="mission-info">
          <h3 class="mission-name">New Shepard  NS-27</h3>
          <p class="mission-description">Suborbital research mission carrying scientific payloads and experiments to the edge of space. This mission will test new technologies for future orbital flights.</p>
          
          <div class="launch-details">
            <div class="detail-item">
              <span class="detail-label">Rocket:</span>
              <span class="detail-value">New Shepard</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Site:</span>
              <span class="detail-value">West Texas Facility</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Time:</span>
              <span class="detail-value">Today  10:30 AM CDT</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Flight Duration:</span>
              <span class="detail-value">~11 minutes</span>
            </div>
          </div>
        </div>

        <div class="countdown-section">
          <div class="countdown-timer">
            <div class="countdown-display">
              <span class="time-unit">
                <span class="number" style="color: var(--launch-live);">LIVE</span>
                <span class="label">Now</span>
              </span>
              <span class="time-unit">
                <span class="number">T+</span>
                <span class="label">03:45</span>
              </span>
              <span class="time-unit">
                <span class="number">ALT</span>
                <span class="label">85km</span>
              </span>
              <span class="time-unit">
                <span class="number">VEL</span>
                <span class="label">Mach 2.8</span>
              </span>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar" style="width: 35%; background: var(--launch-live);"></div>
            </div>
          </div>
        </div>

        <div class="launch-actions">
          <button class="action-btn primary" onclick="openMissionModal(this)">Watch Live</button>
          <button class="action-btn secondary" onclick="setNotification(this)"> Stream</button>
          <button class="action-btn secondary" onclick="shareLaunch(this)"> Share</button>
        </div>
      </article>

      <!-- Launch Card 4: ESA Ariane 6 -->
      <article class="launch-card" data-agency="esa" data-status="upcoming" data-launch-id="ariane-6-maiden-flight">
        <div class="launch-header">
          <div class="agency-badge esa">
            <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/esa.svg" alt="ESA" class="agency-logo" style="filter: invert(1);">
            <span class="agency-name">ESA</span>
          </div>
          <div class="launch-status status-upcoming">Upcoming</div>
        </div>
        
        <div class="mission-info">
          <h3 class="mission-name">Ariane 6  Maiden Flight</h3>
          <p class="mission-description">First flight of Europe's new Ariane 6 rocket, carrying multiple satellites and demonstrating the capabilities of ESA's next-generation launch vehicle.</p>
          
          <div class="launch-details">
            <div class="detail-item">
              <span class="detail-label">Rocket:</span>
              <span class="detail-value">Ariane 6</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Site:</span>
              <span class="detail-value">Kourou, French Guiana</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Window:</span>
              <span class="detail-value">December 2024  TBD</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Payload:</span>
              <span class="detail-value">Multiple Satellites</span>
            </div>
          </div>
        </div>

        <div class="countdown-section">
          <div class="countdown-timer" data-launch-time="2025-01-15T14:30:00Z" data-precision="exact">
            <div class="countdown-display">
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Days</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Hours</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Min</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">Sec</span>
              </span>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="launch-actions">
          <button class="action-btn primary" onclick="openMissionModal(this)">View Details</button>
          <button class="action-btn secondary" onclick="setNotification(this)"> Notify Me</button>
          <button class="action-btn secondary" onclick="shareLaunch(this)"> Share</button>
        </div>
      </article>

      <!-- Launch Card 5: SpaceX Starship -->
      <article class="launch-card" data-agency="spacex" data-status="delayed" data-launch-id="starship-ift-5">
        <div class="launch-header">
          <div class="agency-badge spacex">
            <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/spacex.svg" alt="SpaceX" class="agency-logo" style="filter: invert(1);">
            <span class="agency-name">SpaceX</span>
          </div>
          <div class="launch-status status-delayed">Delayed</div>
        </div>
        
        <div class="mission-info">
          <h3 class="mission-name">Starship  IFT-5</h3>
          <p class="mission-description">Fifth integrated flight test of Starship and Super Heavy booster. This test will demonstrate orbital refueling capabilities and advanced landing procedures.</p>
          
          <div class="launch-details">
            <div class="detail-item">
              <span class="detail-label">Rocket:</span>
              <span class="detail-value">Starship + Super Heavy</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Site:</span>
              <span class="detail-value">Starbase, Texas</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Status:</span>
              <span class="detail-value">Awaiting FAA Approval</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Mission Duration:</span>
              <span class="detail-value">~90 minutes</span>
            </div>
          </div>
        </div>

        <div class="countdown-section">
          <div class="countdown-timer">
            <div class="countdown-display">
              <span class="time-unit">
                <span class="number" style="color: var(--launch-delayed);">TBD</span>
                <span class="label">Date</span>
              </span>
              <span class="time-unit">
                <span class="number">FAA</span>
                <span class="label">Pending</span>
              </span>
              <span class="time-unit">
                <span class="number">ENV</span>
                <span class="label">Review</span>
              </span>
              <span class="time-unit">
                <span class="number">--</span>
                <span class="label">--</span>
              </span>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar" style="width: 10%; background: var(--launch-delayed);"></div>
            </div>
          </div>
        </div>

        <div class="launch-actions">
          <button class="action-btn primary" onclick="openMissionModal(this)">View Details</button>
          <button class="action-btn secondary" onclick="setNotification(this)"> Updates</button>
          <button class="action-btn secondary" onclick="shareLaunch(this)"> Share</button>
        </div>
      </article>

      <!-- Launch Card 6: International Mission -->
      <article class="launch-card" data-agency="international" data-status="success" data-launch-id="isro-chandrayaan-4">
        <div class="launch-header">
          <div class="agency-badge international">
            <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/nasa.svg" alt="ISRO" class="agency-logo" style="filter: invert(1);">
            <span class="agency-name">ISRO</span>
          </div>
          <div class="launch-status status-success">Success</div>
        </div>
        
        <div class="mission-info">
          <h3 class="mission-name">PSLV-C58  Chandrayaan-4</h3>
          <p class="mission-description">India's fourth lunar mission successfully launched, carrying advanced scientific instruments to study the Moon's south polar region and search for water ice deposits.</p>
          
          <div class="launch-details">
            <div class="detail-item">
              <span class="detail-label">Rocket:</span>
              <span class="detail-value">PSLV-C58</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Site:</span>
              <span class="detail-value">Satish Dhawan Space Centre</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Launch Time:</span>
              <span class="detail-value">September 28, 2024  14:30 IST</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Mission Status:</span>
              <span class="detail-value">En Route to Moon</span>
            </div>
          </div>
        </div>

        <div class="countdown-section">
          <div class="countdown-timer">
            <div class="countdown-display">
              <span class="time-unit">
                <span class="number" style="color: var(--launch-success);"></span>
                <span class="label">Success</span>
              </span>
              <span class="time-unit">
                <span class="number">16</span>
                <span class="label">Days Ago</span>
              </span>
              <span class="time-unit">
                <span class="number">MOON</span>
                <span class="label">Bound</span>
              </span>
              <span class="time-unit">
                <span class="number">45</span>
                <span class="label">Days ETA</span>
              </span>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar" style="width: 100%; background: var(--launch-success);"></div>
            </div>
          </div>
        </div>

        <div class="launch-actions">
          <button class="action-btn primary" onclick="openMissionModal(this)">Mission Status</button>
          <button class="action-btn secondary" onclick="setNotification(this)"> Tracking</button>
          <button class="action-btn secondary" onclick="shareLaunch(this)"> Share</button>
        </div>
      </article>
    </section>

    <div class="placeholder-content">
      <h2> Launch Dashboard Ready!</h2>
      <p>
        The responsive launch dashboard layout is now complete with CSS Grid, loading skeletons, 
        and mobile optimization. Ready for real launch data integration!
      </p>
      <p>
        <strong>Layout Features Implemented:</strong><br>
         Responsive 3-column grid (desktop)  2-column (tablet)  1-column (mobile)<br>
         Advanced filter and search controls with smooth animations<br>
         Loading skeleton animations for smooth data loading<br>
         Enhanced dashboard header with live statistics<br>
         Mobile-optimized touch-friendly interface
      </p>
    </div>
  </main>

  <footer>
    <div style="flex:1;display:flex;flex-direction:column;align-items:flex-start;gap:0.5em;">
      <a href="#"><img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg"
          alt="Google Play Store" style="height:40px;"></a>
      <a href="#"><img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg"
          alt="Apple Store" style="height:40px;"></a>
    </div>

    <div style="flex:2;text-align:center;">
      <div style="font-weight:bold;margin-bottom:0.5em;">BlueandCosmos</div>
      <div style="font-size:0.9em;opacity:0.9;">Explore the Universe  Discover the Cosmos</div>
      <div style="margin-top:1em;font-size:0.8em;">
        <a href="privacy.html">Privacy Policy</a> | 
        <a href="terms.html">Terms of Service</a> | 
        <a href="contact.html">Contact</a>
      </div>
    </div>

    <div style="flex:1;display:flex;flex-direction:column;align-items:flex-end;gap:0.5em;">
      <div style="font-weight:bold;">Let's Connect!</div>
      <div style="display:flex;gap:0.5em;">
        <a href="https://twitter.com/blueandcosmos" target="_blank" rel="noopener"><img
            src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/x.svg" alt="X"
            style="height:24px;filter:invert(1);"></a>
        <a href="https://instagram.com/blueandcosmos" target="_blank" rel="noopener"><img
            src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="Instagram"
            style="height:24px;filter:invert(1);"></a>
        <a href="https://tiktok.com/@blueandcosmos" target="_blank" rel="noopener"><img
            src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/tiktok.svg" alt="TikTok"
            style="height:24px;filter:invert(1);"></a>
        <a href="https://youtube.com/@blueandcosmos" target="_blank" rel="noopener"><img
            src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/youtube.svg" alt="YouTube"
            style="height:24px;filter:invert(1);"></a>
      </div>
    </div>
  </footer>

  <!-- Mission Detail Modal -->
  <div class="modal-overlay" id="mission-modal">
    <div class="modal-content large">
      <button class="modal-close" title="Close" onclick="closeMissionModal()">&times;</button>
      
      <div class="modal-header">
        <div class="mission-patch">
          <img id="modal-mission-patch" src="" alt="Mission Patch">
        </div>
        <div class="mission-title-section">
          <h1 class="modal-mission-name" id="modal-mission-name">Mission Name</h1>
          <p class="modal-mission-subtitle" id="modal-mission-subtitle">Mission Subtitle</p>
          <div class="modal-agency-info">
            <img id="modal-agency-logo" src="" alt="Agency" class="modal-agency-logo">
            <span class="modal-agency-name" id="modal-agency-name">Agency Name</span>
          </div>
        </div>
        <div class="modal-countdown-section">
          <div class="modal-countdown" id="modal-countdown">
            <span class="time-unit">
              <span class="number">--</span>
              <span class="label">Days</span>
            </span>
            <span class="time-unit">
              <span class="number">--</span>
              <span class="label">Hours</span>
            </span>
            <span class="time-unit">
              <span class="number">--</span>
              <span class="label">Min</span>
            </span>
            <span class="time-unit">
              <span class="number">--</span>
              <span class="label">Sec</span>
            </span>
          </div>
        </div>
      </div>

      <div class="modal-body">
        <div class="modal-tabs">
          <button class="tab-btn active" data-tab="overview" onclick="switchModalTab('overview')">Overview</button>
          <button class="tab-btn" data-tab="rocket" onclick="switchModalTab('rocket')">Rocket</button>
          <button class="tab-btn" data-tab="timeline" onclick="switchModalTab('timeline')">Timeline</button>
          <button class="tab-btn" data-tab="media" onclick="switchModalTab('media')">Media</button>
        </div>

        <div class="tab-content active" id="overview-tab">
          <div class="mission-overview">
            <div class="overview-section">
              <h3>Mission Objectives</h3>
              <p id="modal-mission-objectives">Loading mission objectives...</p>
            </div>
            
            <div class="mission-stats">
              <div class="stat-item">
                <span class="stat-value" id="modal-mission-cost">$0</span>
                <span class="stat-label">Mission Cost</span>
              </div>
              <div class="stat-item">
                <span class="stat-value" id="modal-mission-duration">0 days</span>
                <span class="stat-label">Mission Duration</span>
              </div>
              <div class="stat-item">
                <span class="stat-value" id="modal-payload-mass">0 kg</span>
                <span class="stat-label">Payload Mass</span>
              </div>
              <div class="stat-item">
                <span class="stat-value" id="modal-success-rate">0%</span>
                <span class="stat-label">Rocket Success Rate</span>
              </div>
            </div>

            <div class="mission-details-grid">
              <div class="detail-section">
                <h4>Launch Details</h4>
                <div class="detail-list" id="modal-launch-details">
                  <!-- Dynamic content -->
                </div>
              </div>
              <div class="detail-section">
                <h4>Payload Information</h4>
                <div class="detail-list" id="modal-payload-details">
                  <!-- Dynamic content -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-content" id="rocket-tab">
          <div class="rocket-specs">
            <div class="rocket-diagram">
              <div class="rocket-visual" id="modal-rocket-visual">
                <div class="rocket-illustration"></div>
                <div class="rocket-name" id="modal-rocket-name">Rocket Name</div>
              </div>
            </div>
            <div class="specs-table">
              <h3>Rocket Specifications</h3>
              <table id="modal-rocket-specs">
                <tbody>
                  <!-- Dynamic content -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="tab-content" id="timeline-tab">
          <div class="mission-timeline" id="modal-timeline">
            <!-- Dynamic timeline content -->
          </div>
        </div>

        <div class="tab-content" id="media-tab">
          <div class="media-gallery" id="modal-media-gallery">
            <div class="media-placeholder">
              <h3>Mission Media</h3>
              <p>Images, videos, and media content will be displayed here</p>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <div class="live-countdown">
          <span class="countdown-label">Launch in:</span>
          <div class="countdown-display compact" id="modal-footer-countdown">
            <span class="time-unit"><span class="number">--</span><span class="label">D</span></span>
            <span class="time-unit"><span class="number">--</span><span class="label">H</span></span>
            <span class="time-unit"><span class="number">--</span><span class="label">M</span></span>
            <span class="time-unit"><span class="number">--</span><span class="label">S</span></span>
          </div>
        </div>
        <div class="modal-actions">
          <button class="action-btn primary" id="modal-primary-action"> Set Launch Alert</button>
          <button class="action-btn secondary" id="modal-stream-action"> Watch Live Stream</button>
          <button class="action-btn secondary" id="modal-share-action"> Share Mission</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Theme Toggle Functionality (Inherited from BlueandCosmos)
    function toggleTheme() {
      document.body.classList.toggle('dark');
      const isDark = document.body.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    // Load saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.body.classList.add('dark');
    }

    // Moon Phase Widget (Inherited functionality)
    function updateMoonPhase() {
      const moonPhases = [
        { phase: "New Moon", icon: "", context: "New Beginnings" },
        { phase: "Waxing Crescent", icon: "", context: "Growing Light" },
        { phase: "First Quarter", icon: "", context: "Half Illuminated" },
        { phase: "Waxing Gibbous", icon: "", context: "Nearly Full" },
        { phase: "Full Moon", icon: "", context: "Complete Illumination" },
        { phase: "Waning Gibbous", icon: "", context: "Decreasing Light" },
        { phase: "Last Quarter", icon: "", context: "Half in Shadow" },
        { phase: "Waning Crescent", icon: "", context: "Fading Light" }
      ];

      // Simple moon phase calculation (approximate)
      const now = new Date();
      const daysSinceNewMoon = Math.floor((now.getTime() - new Date('2024-01-11').getTime()) / (1000 * 60 * 60 * 24));
      const phaseIndex = Math.floor((daysSinceNewMoon % 29.53) / 29.53 * 8);
      const currentPhase = moonPhases[phaseIndex] || moonPhases[0];

      const moonLabel = document.getElementById('moon-phase');
      const moonContext = document.getElementById('moon-context');
      const moonIcon = document.querySelector('.moon-icon');

      if (moonLabel && moonContext && moonIcon) {
        moonLabel.textContent = currentPhase.phase;
        moonContext.textContent = currentPhase.context;
        moonIcon.textContent = currentPhase.icon;
      }
    }

    // Dropdown Navigation (Inherited functionality)
    (function stickyDropdowns() {
      const OPEN = "open";
      const DELAY = 160;
      document.querySelectorAll(".dropdown").forEach(dd => {
        let t = null;
        const btn = dd.querySelector(".dropbtn");
        const menu = dd.querySelector(".dropdown-content");

        function open() {
          dd.classList.add(OPEN);
          btn?.setAttribute("aria-expanded", "true");
          if (t) {
            clearTimeout(t);
            t = null;
          }
        }

        function close() {
          if (t) clearTimeout(t);
          t = setTimeout(() => {
            dd.classList.remove(OPEN);
            btn?.setAttribute("aria-expanded", "false");
          }, DELAY);
        }

        dd.addEventListener("mouseenter", open);
        dd.addEventListener("mouseleave", close);
        btn?.addEventListener("focus", open);
        btn?.addEventListener("blur", close);
        menu?.addEventListener("mouseenter", open);
        menu?.addEventListener("mouseleave", close);
      });
    })();

    // Filter and View Controls
    function initializeControls() {
      // Filter button functionality
      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(btn => {
        btn.addEventListener('click', function() {
          // Remove active class from all filter buttons
          filterButtons.forEach(b => b.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
          
          const filter = this.dataset.filter;
          console.log(`Filter selected: ${filter}`);
          
          // Apply filter using data manager
          applyFilter(filter);
          
          // Add visual feedback
          this.style.transform = 'scale(0.95)';
          setTimeout(() => {
            this.style.transform = '';
          }, 150);
        });
      });

      // View button functionality
      const viewButtons = document.querySelectorAll('.view-btn');
      viewButtons.forEach(btn => {
        btn.addEventListener('click', function() {
          // Remove active class from all view buttons
          viewButtons.forEach(b => b.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
          
          const view = this.dataset.view;
          console.log(`View selected: ${view}`);
          
          // Add visual feedback
          this.style.transform = 'scale(0.95)';
          setTimeout(() => {
            this.style.transform = '';
          }, 150);
        });
      });

      // Search functionality
      const searchInput = document.getElementById('mission-search');
      const searchBtn = document.querySelector('.search-btn');
      
      if (searchInput) {
        searchInput.addEventListener('input', function() {
          const query = this.value.trim();
          if (query.length > 2) {
            console.log(`Searching for: ${query}`);
            performSearch(query);
            // Add search visual feedback
            this.style.borderColor = 'var(--launch-success)';
            setTimeout(() => {
              this.style.borderColor = '';
            }, 300);
          } else if (query.length === 0) {
            // Reset to all launches when search is cleared
            applyFilter('all');
          }
        });

        searchInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            performSearchAction();
          }
        });
      }

      if (searchBtn) {
        searchBtn.addEventListener('click', performSearchAction);
      }

      function performSearchAction() {
        const query = searchInput.value.trim();
        if (query) {
          console.log(`Performing search for: ${query}`);
          performSearch(query);
          // Add button animation
          searchBtn.style.transform = 'scale(0.9)';
          setTimeout(() => {
            searchBtn.style.transform = '';
          }, 150);
        }
      }
    }

    // Loading Skeleton Animation Controller
    function animateSkeletons() {
      const skeletons = document.querySelectorAll('.loading-skeleton');
      skeletons.forEach((skeleton, index) => {
        // Stagger the animation start times
        skeleton.style.animationDelay = `${index * 0.1}s`;
      });
    }

    // Statistics Animation
    function animateStatistics() {
      const statNumbers = document.querySelectorAll('.stat-number');
      statNumbers.forEach((stat, index) => {
        const finalValue = stat.textContent;
        let currentValue = 0;
        const increment = finalValue.includes('%') ? 
          parseFloat(finalValue) / 20 : 
          parseInt(finalValue) / 20;
        
        stat.textContent = '0';
        
        const timer = setInterval(() => {
          currentValue += increment;
          if (currentValue >= parseFloat(finalValue)) {
            stat.textContent = finalValue;
            clearInterval(timer);
          } else {
            stat.textContent = finalValue.includes('%') ? 
              `${currentValue.toFixed(1)}%` : 
              Math.floor(currentValue).toString();
          }
        }, 50);
      });
    }

    // Launch Card Interactions
    function initializeLaunchCards() {
      // Add hover effects to launch cards
      const launchCards = document.querySelectorAll('.launch-card');
      launchCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-5px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
          this.style.transform = '';
        });
      });

      // Initialize countdown system (handled by CountdownManager)
      // Legacy support for animateCountdowns function
      animateCountdowns();
    }

    // Advanced Countdown Manager System
    class CountdownManager {
      constructor() {
        this.countdowns = new Map();
        this.isRunning = false;
        this.intervalId = null;
        this.syncOffset = 0; // Time synchronization offset
        this.lastSyncTime = 0;
        this.urgencyThresholds = {
          critical: 60 * 60 * 1000, // 1 hour
          warning: 24 * 60 * 60 * 1000, // 24 hours
          normal: 7 * 24 * 60 * 60 * 1000 // 7 days
        };
      }

      init() {
        this.syncTime();
        this.registerCountdowns();
        this.start();
        
        // Re-sync time every 5 minutes
        setInterval(() => this.syncTime(), 5 * 60 * 1000);
      }

      async syncTime() {
        try {
          const startTime = performance.now();
          const response = await fetch('https://worldtimeapi.org/api/timezone/UTC');
          const endTime = performance.now();
          
          if (response.ok) {
            const data = await response.json();
            const serverTime = new Date(data.utc_datetime);
            const networkDelay = (endTime - startTime) / 2;
            const localTime = new Date();
            
            this.syncOffset = serverTime.getTime() + networkDelay - localTime.getTime();
            this.lastSyncTime = Date.now();
            
            console.log(` Time synchronized. Offset: ${this.syncOffset}ms`);
          }
        } catch (error) {
          console.warn('Time sync failed, using local time:', error);
          this.syncOffset = 0;
        }
      }

      getCurrentTime() {
        return new Date(Date.now() + this.syncOffset);
      }

      registerCountdowns() {
        const countdownTimers = document.querySelectorAll('.countdown-timer[data-launch-time]');
        countdownTimers.forEach((timer, index) => {
          const launchTime = new Date(timer.dataset.launchTime);
          const countdownId = `countdown-${index}`;
          
          this.countdowns.set(countdownId, {
            element: timer,
            launchTime: launchTime,
            lastUpdate: 0,
            urgencyLevel: 'normal',
            milestones: new Set(),
            precision: timer.dataset.precision || 'exact'
          });
        });

        // Register main dashboard countdown
        const mainCountdown = document.getElementById('next-countdown');
        if (mainCountdown) {
          // Find the next upcoming launch
          const nextLaunch = this.getNextLaunch();
          if (nextLaunch) {
            this.countdowns.set('main-countdown', {
              element: mainCountdown,
              launchTime: nextLaunch.launchTime,
              lastUpdate: 0,
              urgencyLevel: 'normal',
              milestones: new Set(),
              precision: 'exact'
            });
          }
        }
      }

      getNextLaunch() {
        const now = this.getCurrentTime();
        let nextLaunch = null;
        let minTimeDiff = Infinity;

        this.countdowns.forEach(countdown => {
          const timeDiff = countdown.launchTime - now;
          if (timeDiff > 0 && timeDiff < minTimeDiff) {
            minTimeDiff = timeDiff;
            nextLaunch = countdown;
          }
        });

        return nextLaunch;
      }

      start() {
        if (this.isRunning) return;
        
        this.isRunning = true;
        this.intervalId = setInterval(() => {
          this.updateAllCountdowns();
        }, 100); // Update every 100ms for smooth animations
      }

      stop() {
        if (this.intervalId) {
          clearInterval(this.intervalId);
          this.intervalId = null;
        }
        this.isRunning = false;
      }

      updateAllCountdowns() {
        const now = this.getCurrentTime();
        
        this.countdowns.forEach((countdown, id) => {
          this.updateCountdown(countdown, now);
        });
      }

      updateCountdown(countdown, now) {
        const timeDiff = countdown.launchTime - now;
        const element = countdown.element;
        
        if (timeDiff <= 0) {
          this.handleLaunchComplete(countdown);
          return;
        }

        // Calculate time units
        const timeUnits = this.calculateTimeUnits(timeDiff);
        
        // Update urgency level
        const newUrgencyLevel = this.getUrgencyLevel(timeDiff);
        if (newUrgencyLevel !== countdown.urgencyLevel) {
          countdown.urgencyLevel = newUrgencyLevel;
          this.applyUrgencyStyles(element, newUrgencyLevel);
        }

        // Update display
        this.updateCountdownDisplay(element, timeUnits, countdown.precision);
        
        // Update progress bar
        this.updateProgressBar(element, timeDiff);
        
        // Check milestones
        this.checkMilestones(countdown, timeDiff);
        
        countdown.lastUpdate = now.getTime();
      }

      calculateTimeUnits(timeDiff) {
        const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
        const milliseconds = Math.floor(timeDiff % 1000);

        return { days, hours, minutes, seconds, milliseconds };
      }

      updateCountdownDisplay(element, timeUnits, precision) {
        const timeElements = element.querySelectorAll('.time-unit .number');
        
        if (timeElements.length >= 4) {
          // Animate number changes
          this.animateNumberChange(timeElements[0], timeUnits.days.toString().padStart(2, '0'));
          this.animateNumberChange(timeElements[1], timeUnits.hours.toString().padStart(2, '0'));
          this.animateNumberChange(timeElements[2], timeUnits.minutes.toString().padStart(2, '0'));
          
          if (precision === 'exact' && timeUnits.days === 0 && timeUnits.hours === 0) {
            // Show milliseconds for final minute
            if (timeUnits.minutes === 0) {
              this.animateNumberChange(timeElements[3], `${timeUnits.seconds}.${Math.floor(timeUnits.milliseconds / 100)}`);
            } else {
              this.animateNumberChange(timeElements[3], timeUnits.seconds.toString().padStart(2, '0'));
            }
          } else {
            this.animateNumberChange(timeElements[3], timeUnits.seconds.toString().padStart(2, '0'));
          }
        }
      }

      animateNumberChange(element, newValue) {
        if (element.textContent !== newValue) {
          element.style.transform = 'scale(1.1)';
          element.style.color = 'var(--highlight)';
          
          setTimeout(() => {
            element.textContent = newValue;
            element.style.transform = '';
            element.style.color = '';
          }, 50);
        }
      }

      updateProgressBar(element, timeDiff) {
        const progressBar = element.querySelector('.progress-bar');
        if (!progressBar) return;

        // Calculate progress based on different time ranges
        let totalTime, progress;
        
        if (timeDiff > 30 * 24 * 60 * 60 * 1000) { // > 30 days
          totalTime = 90 * 24 * 60 * 60 * 1000; // 90 days
        } else if (timeDiff > 7 * 24 * 60 * 60 * 1000) { // > 7 days
          totalTime = 30 * 24 * 60 * 60 * 1000; // 30 days
        } else if (timeDiff > 24 * 60 * 60 * 1000) { // > 1 day
          totalTime = 7 * 24 * 60 * 60 * 1000; // 7 days
        } else {
          totalTime = 24 * 60 * 60 * 1000; // 24 hours
        }

        const elapsed = totalTime - timeDiff;
        progress = Math.max(0, Math.min(100, (elapsed / totalTime) * 100));
        
        progressBar.style.width = `${progress}%`;
        
        // Update progress bar color based on urgency
        const urgencyLevel = this.getUrgencyLevel(timeDiff);
        if (urgencyLevel === 'critical') {
          progressBar.style.background = 'linear-gradient(90deg, var(--launch-failure), var(--launch-live))';
        } else if (urgencyLevel === 'warning') {
          progressBar.style.background = 'linear-gradient(90deg, var(--launch-delayed), var(--launch-upcoming))';
        } else {
          progressBar.style.background = 'linear-gradient(90deg, var(--launch-upcoming), var(--accent))';
        }
      }

      getUrgencyLevel(timeDiff) {
        if (timeDiff <= this.urgencyThresholds.critical) return 'critical';
        if (timeDiff <= this.urgencyThresholds.warning) return 'warning';
        return 'normal';
      }

      applyUrgencyStyles(element, urgencyLevel) {
        const card = element.closest('.launch-card');
        if (!card) return;

        // Remove existing urgency classes
        card.classList.remove('urgency-normal', 'urgency-warning', 'urgency-critical');
        
        // Add new urgency class
        card.classList.add(`urgency-${urgencyLevel}`);

        // Update countdown section styling
        const countdownSection = element.closest('.countdown-section');
        if (countdownSection) {
          countdownSection.classList.remove('urgency-normal', 'urgency-warning', 'urgency-critical');
          countdownSection.classList.add(`urgency-${urgencyLevel}`);
        }
      }

      checkMilestones(countdown, timeDiff) {
        const milestones = [
          { time: 24 * 60 * 60 * 1000, message: '24 hours until launch!' },
          { time: 60 * 60 * 1000, message: '1 hour until launch!' },
          { time: 10 * 60 * 1000, message: '10 minutes until launch!' },
          { time: 60 * 1000, message: '1 minute until launch!' },
          { time: 10 * 1000, message: '10 seconds until launch!' }
        ];

        milestones.forEach(milestone => {
          const milestoneKey = `milestone-${milestone.time}`;
          
          if (timeDiff <= milestone.time && !countdown.milestones.has(milestoneKey)) {
            countdown.milestones.add(milestoneKey);
            this.showMilestoneNotification(milestone.message);
          }
        });
      }

      showMilestoneNotification(message) {
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 140px;
          right: 20px;
          background: var(--launch-live);
          color: white;
          padding: 1em 1.5em;
          border-radius: 8px;
          font-size: 0.9em;
          font-weight: bold;
          z-index: 10002;
          animation: slideInRight 0.3s ease;
          box-shadow: 0 4px 12px rgba(255, 68, 68, 0.3);
        `;
        notification.textContent = ` ${message}`;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOutRight 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }, 5000);
      }

      handleLaunchComplete(countdown) {
        const element = countdown.element;
        const timeElements = element.querySelectorAll('.time-unit .number');
        
        if (timeElements.length >= 4) {
          timeElements[0].textContent = 'LAUNCH';
          timeElements[1].textContent = 'COMPLETE';
          timeElements[2].textContent = '';
          timeElements[3].textContent = '';
        }

        // Update progress bar to 100%
        const progressBar = element.querySelector('.progress-bar');
        if (progressBar) {
          progressBar.style.width = '100%';
          progressBar.style.background = 'var(--launch-success)';
        }

        // Show launch complete notification
        this.showMilestoneNotification('Launch Complete! ');
      }

      // Public API
      addCountdown(launchTime, element, options = {}) {
        const countdownId = `custom-${Date.now()}`;
        this.countdowns.set(countdownId, {
          element: element,
          launchTime: new Date(launchTime),
          lastUpdate: 0,
          urgencyLevel: 'normal',
          milestones: new Set(),
          precision: options.precision || 'exact'
        });
        return countdownId;
      }

      removeCountdown(countdownId) {
        this.countdowns.delete(countdownId);
      }

      getCountdownInfo(countdownId) {
        return this.countdowns.get(countdownId);
      }
    }

    // Initialize global countdown manager
    const countdownManager = new CountdownManager();

    // Launch Data Management System
    class LaunchDataManager {
      constructor() {
        this.launches = new Map();
        this.cache = new Map();
        this.lastUpdate = 0;
        this.updateInterval = 5 * 60 * 1000; // 5 minutes
        this.retryAttempts = 3;
        this.retryDelay = 2000; // 2 seconds
        this.apiEndpoints = {
          spacex: 'https://api.spacexdata.com/v4/launches',
          nasa: 'https://api.nasa.gov/planetary/apod',
          launchLibrary: 'https://ll.thespacedevs.com/2.2.0/launch/upcoming/',
          blueOrigin: null // No public API available
        };
        this.fallbackData = this.createFallbackData();
      }

      async init() {
        console.log(' Initializing Launch Data Manager...');
        
        // Load cached data first
        this.loadFromCache();
        
        // Fetch fresh data
        await this.fetchAllLaunches();
        
        // Set up periodic updates
        this.startPeriodicUpdates();
        
        console.log(' Launch Data Manager initialized');
      }

      async fetchAllLaunches() {
        const fetchPromises = [
          this.fetchSpaceXLaunches(),
          this.fetchLaunchLibraryData(),
          this.fetchNASAData()
        ];

        try {
          const results = await Promise.allSettled(fetchPromises);
          
          // Process results and handle failures gracefully
          const allLaunches = [];
          
          results.forEach((result, index) => {
            if (result.status === 'fulfilled' && result.value) {
              allLaunches.push(...result.value);
            } else {
              const sources = ['SpaceX', 'Launch Library', 'NASA'];
              console.warn(`Failed to fetch ${sources[index]} data:`, result.reason);
            }
          });

          // Combine and process all launch data
          const processedLaunches = this.combineAndSort(allLaunches);
          
          // Update internal storage
          this.updateLaunchData(processedLaunches);
          
          // Cache the data
          this.saveToCache(processedLaunches);
          
          this.lastUpdate = Date.now();
          
          return processedLaunches;
          
        } catch (error) {
          console.error('Error fetching launch data:', error);
          return this.getFallbackData();
        }
      }

      async fetchSpaceXLaunches() {
        try {
          console.log(' Fetching SpaceX launch data...');
          
          // Fetch multiple SpaceX endpoints for comprehensive data
          const [upcomingResponse, recentResponse, rocketsResponse, launchpadsResponse] = await Promise.allSettled([
            this.fetchWithRetry(`${this.apiEndpoints.spacex}/upcoming?limit=15`),
            this.fetchWithRetry(`${this.apiEndpoints.spacex}/past?limit=5&order=desc`),
            this.fetchWithRetry('https://api.spacexdata.com/v4/rockets'),
            this.fetchWithRetry('https://api.spacexdata.com/v4/launchpads')
          ]);

          let allLaunches = [];
          let rocketData = {};
          let launchpadData = {};

          // Process rockets data for enhanced information
          if (rocketsResponse.status === 'fulfilled' && rocketsResponse.value.ok) {
            const rockets = await rocketsResponse.value.json();
            rockets.forEach(rocket => {
              rocketData[rocket.id] = rocket;
            });
            console.log(` Loaded ${rockets.length} SpaceX rocket configurations`);
          }

          // Process launchpads data
          if (launchpadsResponse.status === 'fulfilled' && launchpadsResponse.value.ok) {
            const launchpads = await launchpadsResponse.value.json();
            launchpads.forEach(pad => {
              launchpadData[pad.id] = pad;
            });
            console.log(` Loaded ${launchpads.length} SpaceX launchpad configurations`);
          }

          // Process upcoming launches
          if (upcomingResponse.status === 'fulfilled' && upcomingResponse.value.ok) {
            const upcomingData = await upcomingResponse.value.json();
            const upcomingLaunches = this.parseSpaceXData(upcomingData, rocketData, launchpadData, 'upcoming');
            allLaunches.push(...upcomingLaunches);
            console.log(` Processed ${upcomingLaunches.length} upcoming SpaceX launches`);
          }

          // Process recent launches
          if (recentResponse.status === 'fulfilled' && recentResponse.value.ok) {
            const recentData = await recentResponse.value.json();
            const recentLaunches = this.parseSpaceXData(recentData, rocketData, launchpadData, 'recent');
            allLaunches.push(...recentLaunches);
            console.log(` Processed ${recentLaunches.length} recent SpaceX launches`);
          }

          if (allLaunches.length === 0) {
            throw new Error('No SpaceX data available');
          }

          console.log(` SpaceX API integration complete: ${allLaunches.length} total launches`);
          return allLaunches;
          
        } catch (error) {
          console.warn('SpaceX API unavailable, using enhanced fallback data:', error.message);
          return this.getEnhancedSpaceXFallback();
        }
      }

      async fetchLaunchLibraryData() {
        try {
          console.log(' Fetching international launch data from Launch Library...');
          
          // Fetch multiple Launch Library endpoints for comprehensive coverage
          const [upcomingResponse, agenciesResponse, rocketsResponse, padsResponse] = await Promise.allSettled([
            this.fetchWithRetry(`${this.apiEndpoints.launchLibrary}?limit=30&mode=detailed`),
            this.fetchWithRetry('https://ll.thespacedevs.com/2.2.0/agencies/?limit=50'),
            this.fetchWithRetry('https://ll.thespacedevs.com/2.2.0/config/launcher/?limit=50'),
            this.fetchWithRetry('https://ll.thespacedevs.com/2.2.0/pad/?limit=50')
          ]);

          let allLaunches = [];
          let agencyData = {};
          let rocketData = {};
          let padData = {};

          // Process agencies data for enhanced information
          if (agenciesResponse.status === 'fulfilled' && agenciesResponse.value.ok) {
            const agencies = await agenciesResponse.value.json();
            agencies.results?.forEach(agency => {
              agencyData[agency.id] = agency;
            });
            console.log(` Loaded ${agencies.results?.length || 0} international space agencies`);
          }

          // Process rocket configurations
          if (rocketsResponse.status === 'fulfilled' && rocketsResponse.value.ok) {
            const rockets = await rocketsResponse.value.json();
            rockets.results?.forEach(rocket => {
              rocketData[rocket.id] = rocket;
            });
            console.log(` Loaded ${rockets.results?.length || 0} international rocket configurations`);
          }

          // Process launch pads
          if (padsResponse.status === 'fulfilled' && padsResponse.value.ok) {
            const pads = await padsResponse.value.json();
            pads.results?.forEach(pad => {
              padData[pad.id] = pad;
            });
            console.log(` Loaded ${pads.results?.length || 0} international launch pads`);
          }

          // Process upcoming launches with enhanced data
          if (upcomingResponse.status === 'fulfilled' && upcomingResponse.value.ok) {
            const upcomingData = await upcomingResponse.value.json();
            const launches = this.parseInternationalLaunchData(
              upcomingData.results || [], 
              agencyData, 
              rocketData, 
              padData
            );
            allLaunches.push(...launches);
            console.log(` Processed ${launches.length} international launches`);
          }

          if (allLaunches.length === 0) {
            throw new Error('No international launch data available');
          }

          console.log(` International API integration complete: ${allLaunches.length} total launches`);
          return allLaunches;
          
        } catch (error) {
          console.warn('Launch Library API unavailable, using enhanced fallback data:', error.message);
          return this.getEnhancedInternationalFallback();
        }
      }

      async fetchNASAData() {
        try {
          console.log(' Fetching NASA and government launch data...');
          
          // NASA doesn't have a comprehensive launches API, but we can fetch related data
          const [apodResponse, newsResponse] = await Promise.allSettled([
            this.fetchWithRetry('https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&count=5'),
            this.fetchWithRetry('https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY') // Latest APOD for context
          ]);

          let nasaLaunches = [];

          // Create enhanced NASA mission data based on current programs
          nasaLaunches = this.createEnhancedNASAMissions();

          // If we have APOD data, use it to enhance descriptions
          if (apodResponse.status === 'fulfilled' && apodResponse.value.ok) {
            const apodData = await apodResponse.value.json();
            console.log(` Enhanced NASA missions with ${apodData.length || 1} APOD context`);
          }

          console.log(` Processed ${nasaLaunches.length} NASA and government launches`);
          return nasaLaunches;
          
        } catch (error) {
          console.warn('NASA API unavailable, using enhanced fallback data:', error.message);
          return this.getEnhancedNASAFallback();
        }
      }

      async fetchWithRetry(url, options = {}, attempt = 1) {
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
          
          const response = await fetch(url, {
            ...options,
            signal: controller.signal
          });
          
          clearTimeout(timeoutId);
          return response;
          
        } catch (error) {
          if (attempt < this.retryAttempts) {
            console.log(`Retry attempt ${attempt} for ${url}`);
            await new Promise(resolve => setTimeout(resolve, this.retryDelay * attempt));
            return this.fetchWithRetry(url, options, attempt + 1);
          }
          throw error;
        }
      }

      parseSpaceXData(launches, rocketData = {}, launchpadData = {}, category = 'upcoming') {
        return launches.map(launch => {
          const rocket = rocketData[launch.rocket] || {};
          const launchpad = launchpadData[launch.launchpad] || {};
          const payloads = launch.payloads || [];
          
          // Enhanced rocket information
          const rocketInfo = {
            name: rocket.name || 'Unknown Rocket',
            type: this.getSpaceXRocketType(rocket.name),
            reusable: rocket.reusable || false,
            stages: rocket.stages || 2,
            boosters: rocket.boosters || 0,
            height: rocket.height ? `${rocket.height.meters}m` : 'Unknown',
            diameter: rocket.diameter ? `${rocket.diameter.meters}m` : 'Unknown',
            mass: rocket.mass ? `${rocket.mass.kg.toLocaleString()}kg` : 'Unknown',
            payloadToLEO: rocket.payload_weights?.find(p => p.id === 'leo')?.kg || 0,
            payloadToGTO: rocket.payload_weights?.find(p => p.id === 'gto')?.kg || 0,
            firstFlight: rocket.first_flight,
            successRate: this.calculateSpaceXRocketSuccessRate(rocket.name),
            landingLegs: rocket.landing_legs?.number || 0,
            engines: rocket.engines?.number || 0
          };

          // Enhanced launchpad information
          const launchSiteInfo = {
            name: launchpad.full_name || launchpad.name || 'Unknown Launchpad',
            location: launchpad.locality ? `${launchpad.locality}, ${launchpad.region}` : 'Unknown Location',
            status: launchpad.status || 'unknown',
            details: launchpad.details,
            coordinates: launchpad.latitude && launchpad.longitude ? 
              [launchpad.latitude, launchpad.longitude] : null,
            timezone: launchpad.timezone || 'UTC',
            launchAttempts: launchpad.launch_attempts || 0,
            launchSuccesses: launchpad.launch_successes || 0
          };

          // Enhanced payload information
          const payloadInfo = payloads.length > 0 ? {
            name: payloads.map(p => p.name).join(', ') || 'Undisclosed Payload',
            type: payloads[0].type || 'satellite',
            mass: payloads.reduce((total, p) => total + (p.mass_kg || 0), 0),
            orbit: payloads[0].orbit || 'Unknown',
            customers: payloads.map(p => p.customers).flat().filter(Boolean),
            manufacturers: payloads.map(p => p.manufacturers).flat().filter(Boolean),
            nationalities: payloads.map(p => p.nationalities).flat().filter(Boolean)
          } : {
            name: 'Undisclosed Payload',
            type: 'unknown',
            mass: 0,
            orbit: 'Unknown'
          };

          // Enhanced mission description
          let enhancedDescription = launch.details || `SpaceX ${launch.name} mission`;
          if (payloadInfo.customers.length > 0) {
            enhancedDescription += ` for ${payloadInfo.customers.slice(0, 2).join(' and ')}`;
          }
          if (payloadInfo.orbit && payloadInfo.orbit !== 'Unknown') {
            enhancedDescription += ` to ${payloadInfo.orbit} orbit`;
          }

          // Flight number and mission type
          const missionType = this.determineSpaceXMissionType(launch.name, payloadInfo);
          const flightNumber = launch.flight_number || 0;

          return {
            id: `spacex-${launch.id}`,
            name: launch.name,
            description: enhancedDescription,
            agency: 'spacex',
            rocket: rocketInfo,
            payload: payloadInfo,
            launchSite: launchSiteInfo,
            schedule: {
              launchTime: new Date(launch.date_utc),
              precision: launch.date_precision || 'hour',
              window: launch.window || null,
              autoSequenceStart: launch.auto_update ? 'Enabled' : 'Manual'
            },
            status: this.determineSpaceXStatus(launch.date_utc, launch.success, launch.upcoming),
            media: {
              patch: launch.links?.patch?.small || launch.links?.patch?.large,
              patchLarge: launch.links?.patch?.large,
              images: launch.links?.flickr?.original || [],
              webcast: launch.links?.webcast,
              article: launch.links?.article,
              wikipedia: launch.links?.wikipedia,
              reddit: {
                campaign: launch.links?.reddit?.campaign,
                launch: launch.links?.reddit?.launch,
                recovery: launch.links?.reddit?.recovery
              }
            },
            mission: {
              type: missionType,
              flightNumber: flightNumber,
              staticFireDate: launch.static_fire_date_utc ? new Date(launch.static_fire_date_utc) : null,
              crew: launch.crew || [],
              ships: launch.ships || [],
              capsules: launch.capsules || [],
              cores: launch.cores || []
            },
            source: 'spacex-api-enhanced',
            category: category,
            lastUpdated: Date.now()
          };
        });
      }

      getSpaceXRocketType(rocketName) {
        if (!rocketName) return 'orbital';
        
        const name = rocketName.toLowerCase();
        if (name.includes('falcon heavy')) return 'heavy-lift';
        if (name.includes('starship')) return 'super-heavy';
        if (name.includes('falcon 9')) return 'medium-lift';
        if (name.includes('falcon 1')) return 'small-lift';
        return 'orbital';
      }

      calculateSpaceXRocketSuccessRate(rocketName) {
        // Approximate success rates based on historical data
        const successRates = {
          'Falcon 9': 98.7,
          'Falcon Heavy': 100.0,
          'Starship': 60.0, // Early development
          'Falcon 1': 40.0  // Historical
        };
        return successRates[rocketName] || 95.0;
      }

      determineSpaceXMissionType(missionName, payload) {
        if (!missionName) return 'Commercial';
        
        const name = missionName.toLowerCase();
        if (name.includes('crew') || name.includes('dragon')) return 'Crewed';
        if (name.includes('starlink')) return 'Starlink';
        if (name.includes('nasa') || name.includes('iss')) return 'NASA';
        if (name.includes('military') || name.includes('nro') || name.includes('stp')) return 'Military';
        if (payload.customers?.some(c => c.toLowerCase().includes('nasa'))) return 'NASA';
        return 'Commercial';
      }

      determineSpaceXStatus(launchTime, success, upcoming) {
        const now = new Date();
        const launch = new Date(launchTime);
        const timeDiff = launch - now;

        if (success === true) return 'success';
        if (success === false) return 'failure';
        if (upcoming === false && timeDiff < 0) return 'success'; // Assume success if past and not failed
        if (timeDiff < 0) return 'success';
        if (timeDiff < 2 * 60 * 60 * 1000) return 'live'; // Within 2 hours
        return 'upcoming';
      }

      parseInternationalLaunchData(launches, agencyData = {}, rocketData = {}, padData = {}) {
        return launches.map(launch => {
          const agency = agencyData[launch.launch_service_provider?.id] || launch.launch_service_provider || {};
          const rocket = rocketData[launch.rocket?.configuration?.id] || launch.rocket?.configuration || {};
          const pad = padData[launch.pad?.id] || launch.pad || {};
          const mission = launch.mission || {};

          // Enhanced agency information
          const agencyInfo = this.mapInternationalAgency(agency);
          
          // Enhanced rocket information
          const rocketInfo = {
            name: rocket.full_name || rocket.name || 'Unknown Rocket',
            type: this.getInternationalRocketType(rocket.name, agencyInfo.code),
            reusable: rocket.reusable || false,
            family: rocket.family || 'Unknown',
            variant: rocket.variant || 'Standard',
            height: rocket.length ? `${rocket.length}m` : 'Unknown',
            diameter: rocket.diameter ? `${rocket.diameter}m` : 'Unknown',
            stages: rocket.max_stage || 2,
            leoCapacity: rocket.leo_capacity || 0,
            gtoCapacity: rocket.gto_capacity || 0,
            firstFlight: rocket.maiden_flight,
            successfulLaunches: rocket.successful_launches || 0,
            totalLaunches: rocket.total_launch_count || 0,
            successRate: rocket.total_launch_count > 0 ? 
              ((rocket.successful_launches || 0) / rocket.total_launch_count * 100).toFixed(1) : 0,
            manufacturer: rocket.manufacturer?.name || 'Unknown',
            country: agency.country_code || 'Unknown'
          };

          // Enhanced launch site information
          const launchSiteInfo = {
            name: pad.name || 'Unknown Pad',
            location: pad.location?.name || 'Unknown Location',
            country: pad.location?.country_code || agency.country_code || 'Unknown',
            coordinates: pad.latitude && pad.longitude ? [pad.latitude, pad.longitude] : null,
            timezone: pad.timezone_name || 'UTC',
            totalLaunches: pad.total_launch_count || 0,
            orbitalLaunches: pad.orbital_launch_attempt_count || 0,
            details: pad.info_url || pad.wiki_url
          };

          // Enhanced mission information
          const missionInfo = {
            name: mission.name || 'Unknown Mission',
            type: mission.type || 'Unknown',
            description: mission.description || `${agency.name || 'International'} mission`,
            orbit: mission.orbit?.name || 'Unknown',
            category: this.categorizeInternationalMission(mission, agency)
          };

          // Enhanced description with international context
          let enhancedDescription = mission.description || 
            `${agency.name || 'International space agency'} ${launch.name} mission`;
          
          if (missionInfo.orbit && missionInfo.orbit !== 'Unknown') {
            enhancedDescription += ` to ${missionInfo.orbit}`;
          }

          return {
            id: `intl-${launch.id}`,
            name: launch.name,
            description: enhancedDescription,
            agency: agencyInfo.code,
            rocket: rocketInfo,
            payload: missionInfo,
            launchSite: launchSiteInfo,
            schedule: {
              launchTime: new Date(launch.net),
              precision: this.determineLaunchPrecision(launch.tbddate, launch.tbdtime),
              window: launch.window_start && launch.window_end ? 
                Math.round((new Date(launch.window_end) - new Date(launch.window_start)) / 60000) : null,
              probability: launch.probability || null
            },
            status: this.determineInternationalStatus(launch),
            media: {
              patch: launch.image,
              images: launch.info_urls || [],
              webcast: launch.webcast_live,
              infoUrl: launch.info_url,
              videoUrl: launch.vid_urls?.[0]?.url
            },
            international: {
              agencyType: agency.type || 'Unknown',
              agencyCountry: agency.country_code || 'Unknown',
              launchProvider: agency.name || 'Unknown',
              missionType: missionInfo.category,
              isGovernment: this.isGovernmentAgency(agency),
              isCommercial: agency.type === 'Commercial'
            },
            source: 'launch-library-enhanced',
            lastUpdated: Date.now()
          };
        });
      }

      mapInternationalAgency(agency) {
        if (!agency.name) return { code: 'international', name: 'International' };
        
        const name = agency.name.toLowerCase();
        const country = agency.country_code?.toLowerCase() || '';
        
        // Major space agencies mapping
        if (name.includes('spacex')) return { code: 'spacex', name: 'SpaceX' };
        if (name.includes('nasa')) return { code: 'nasa', name: 'NASA' };
        if (name.includes('blue origin')) return { code: 'blue-origin', name: 'Blue Origin' };
        if (name.includes('esa') || name.includes('arianespace')) return { code: 'esa', name: 'ESA' };
        if (name.includes('isro') || country === 'ind') return { code: 'isro', name: 'ISRO' };
        if (name.includes('cnsa') || name.includes('china') || country === 'chn') return { code: 'cnsa', name: 'CNSA' };
        if (name.includes('roscosmos') || name.includes('russia') || country === 'rus') return { code: 'roscosmos', name: 'Roscosmos' };
        if (name.includes('jaxa') || country === 'jpn') return { code: 'jaxa', name: 'JAXA' };
        if (name.includes('csa') || country === 'can') return { code: 'csa', name: 'CSA' };
        
        return { code: 'international', name: agency.name };
      }

      getInternationalRocketType(rocketName, agencyCode) {
        if (!rocketName) return 'orbital';
        
        const name = rocketName.toLowerCase();
        
        // Heavy-lift rockets
        if (name.includes('falcon heavy') || name.includes('delta iv heavy') || 
            name.includes('ariane 5') || name.includes('long march 5')) return 'heavy-lift';
        
        // Super heavy-lift rockets
        if (name.includes('sls') || name.includes('starship') || 
            name.includes('new glenn')) return 'super-heavy';
        
        // Small-lift rockets
        if (name.includes('electron') || name.includes('vega') || 
            name.includes('pslv')) return 'small-lift';
        
        return 'medium-lift';
      }

      categorizeInternationalMission(mission, agency) {
        if (!mission.type && !agency.name) return 'Commercial';
        
        const missionType = mission.type?.toLowerCase() || '';
        const agencyName = agency.name?.toLowerCase() || '';
        
        if (missionType.includes('human') || missionType.includes('crew')) return 'Crewed';
        if (missionType.includes('government') || this.isGovernmentAgency(agency)) return 'Government';
        if (missionType.includes('military') || missionType.includes('defense')) return 'Military';
        if (missionType.includes('science') || missionType.includes('research')) return 'Science';
        if (agencyName.includes('nasa') || agencyName.includes('esa') || agencyName.includes('jaxa')) return 'Government';
        
        return 'Commercial';
      }

      isGovernmentAgency(agency) {
        if (!agency.type && !agency.name) return false;
        
        const type = agency.type?.toLowerCase() || '';
        const name = agency.name?.toLowerCase() || '';
        
        return type.includes('government') || 
               name.includes('nasa') || name.includes('esa') || name.includes('isro') ||
               name.includes('cnsa') || name.includes('roscosmos') || name.includes('jaxa');
      }

      determineLaunchPrecision(tbdDate, tbdTime) {
        if (tbdDate && tbdTime) return 'tbd';
        if (tbdTime) return 'approximate';
        return 'exact';
      }

      determineInternationalStatus(launch) {
        const now = new Date();
        const launchTime = new Date(launch.net);
        const timeDiff = launchTime - now;

        if (launch.status?.id === 3) return 'success'; // Launch Successful
        if (launch.status?.id === 4) return 'failure'; // Launch Failure
        if (launch.status?.id === 6) return 'delayed'; // On Hold
        if (launch.status?.id === 7) return 'failure'; // Failure
        if (timeDiff < 0) return 'success'; // Assume success if past
        if (timeDiff < 2 * 60 * 60 * 1000) return 'live'; // Within 2 hours
        
        return 'upcoming';
      }

      mapAgency(providerName) {
        if (!providerName) return 'international';
        
        const name = providerName.toLowerCase();
        if (name.includes('spacex')) return 'spacex';
        if (name.includes('nasa')) return 'nasa';
        if (name.includes('blue origin')) return 'blue-origin';
        if (name.includes('esa') || name.includes('arianespace')) return 'esa';
        return 'international';
      }

      determineStatus(launchTime, success) {
        const now = new Date();
        const launch = new Date(launchTime);
        const timeDiff = launch - now;

        if (success === true) return 'success';
        if (success === false) return 'failure';
        if (timeDiff < 0) return 'success'; // Assume success if past and no failure indicated
        if (timeDiff < 60 * 60 * 1000) return 'live'; // Within 1 hour
        return 'upcoming';
      }

      combineAndSort(launchArrays) {
        const allLaunches = launchArrays.flat();
        
        // Remove duplicates based on name and launch time
        const uniqueLaunches = this.removeDuplicates(allLaunches);
        
        // Sort by launch time (earliest first)
        return uniqueLaunches.sort((a, b) => 
          new Date(a.schedule.launchTime) - new Date(b.schedule.launchTime)
        );
      }

      removeDuplicates(launches) {
        const seen = new Set();
        return launches.filter(launch => {
          const key = `${launch.name}-${launch.schedule.launchTime}`;
          if (seen.has(key)) return false;
          seen.add(key);
          return true;
        });
      }

      updateLaunchData(launches) {
        this.launches.clear();
        launches.forEach(launch => {
          this.launches.set(launch.id, launch);
        });
      }

      filterByCategory(category) {
        if (category === 'all') return Array.from(this.launches.values());
        
        return Array.from(this.launches.values()).filter(launch => {
          if (category === 'live') return launch.status === 'live';
          if (category === 'upcoming') return launch.status === 'upcoming';
          if (category === 'recent') return ['success', 'failure'].includes(launch.status);
          return launch.agency === category;
        });
      }

      searchLaunches(query) {
        if (!query || query.length < 2) return Array.from(this.launches.values());
        
        const searchTerm = query.toLowerCase();
        return Array.from(this.launches.values()).filter(launch => 
          launch.name.toLowerCase().includes(searchTerm) ||
          launch.description.toLowerCase().includes(searchTerm) ||
          launch.rocket.name.toLowerCase().includes(searchTerm) ||
          launch.payload.name.toLowerCase().includes(searchTerm) ||
          launch.launchSite.name.toLowerCase().includes(searchTerm)
        );
      }

      getLaunchById(id) {
        return this.launches.get(id);
      }

      getUpcomingLaunches(limit = 10) {
        return this.filterByCategory('upcoming').slice(0, limit);
      }

      getLiveLaunches() {
        return this.filterByCategory('live');
      }

      getRecentLaunches(limit = 10) {
        return this.filterByCategory('recent').slice(0, limit);
      }

      startPeriodicUpdates() {
        setInterval(async () => {
          console.log(' Updating launch data...');
          await this.fetchAllLaunches();
        }, this.updateInterval);
      }

      saveToCache(data) {
        try {
          const cacheData = {
            launches: data,
            timestamp: Date.now()
          };
          localStorage.setItem('launch-missions-cache', JSON.stringify(cacheData));
        } catch (error) {
          console.warn('Failed to save to cache:', error);
        }
      }

      loadFromCache() {
        try {
          const cached = localStorage.getItem('launch-missions-cache');
          if (cached) {
            const cacheData = JSON.parse(cached);
            const age = Date.now() - cacheData.timestamp;
            
            // Use cache if less than 1 hour old
            if (age < 60 * 60 * 1000) {
              this.updateLaunchData(cacheData.launches);
              console.log(' Loaded launch data from cache');
              return true;
            }
          }
        } catch (error) {
          console.warn('Failed to load from cache:', error);
        }
        return false;
      }

      createFallbackData() {
        const baseTime = Date.now();
        return [
          {
            id: 'fallback-spacex-1',
            name: 'Falcon Heavy  Europa Clipper',
            description: 'NASA\'s Europa Clipper mission to Jupiter\'s moon Europa to investigate its subsurface ocean and potential for life.',
            agency: 'spacex',
            rocket: { name: 'Falcon Heavy', type: 'heavy-lift', reusable: true },
            payload: { name: 'Europa Clipper', type: 'interplanetary', mass: 6065 },
            launchSite: { name: 'Kennedy Space Center LC-39A', location: 'Florida, USA' },
            schedule: { launchTime: new Date(baseTime + 72 * 60 * 60 * 1000), precision: 'exact' },
            status: 'upcoming',
            media: { patch: null, images: [], webcast: null },
            source: 'fallback',
            lastUpdated: baseTime
          },
          {
            id: 'fallback-nasa-1',
            name: 'Artemis II  Lunar Flyby',
            description: 'First crewed mission around the Moon since Apollo 17. Four astronauts will fly around the Moon on a 10-day mission.',
            agency: 'nasa',
            rocket: { name: 'Space Launch System (SLS)', type: 'super-heavy', reusable: false },
            payload: { name: 'Orion Crew Capsule', type: 'crewed', mass: 26520 },
            launchSite: { name: 'Kennedy Space Center LC-39B', location: 'Florida, USA' },
            schedule: { launchTime: new Date(baseTime + 45 * 24 * 60 * 60 * 1000), precision: 'approximate' },
            status: 'upcoming',
            media: { patch: null, images: [], webcast: null },
            source: 'fallback',
            lastUpdated: baseTime
          }
        ];
      }

      getEnhancedSpaceXFallback() {
        const baseTime = Date.now();
        return [
          {
            id: 'spacex-fallback-1',
            name: 'Falcon Heavy  Europa Clipper',
            description: 'NASA\'s Europa Clipper mission to Jupiter\'s moon Europa to investigate its subsurface ocean and potential for life. This flagship mission will conduct detailed reconnaissance of Europa\'s ice shell and underlying ocean.',
            agency: 'spacex',
            rocket: {
              name: 'Falcon Heavy',
              type: 'heavy-lift',
              reusable: true,
              stages: 2,
              boosters: 2,
              height: '70m',
              diameter: '3.66m',
              mass: '1,420,788kg',
              payloadToLEO: 63800,
              payloadToGTO: 26700,
              firstFlight: '2018-02-06',
              successRate: 100.0,
              landingLegs: 4,
              engines: 27
            },
            payload: {
              name: 'Europa Clipper',
              type: 'interplanetary',
              mass: 6065,
              orbit: 'Jupiter Transfer',
              customers: ['NASA'],
              manufacturers: ['NASA JPL'],
              nationalities: ['United States']
            },
            launchSite: {
              name: 'Kennedy Space Center LC-39A',
              location: 'Cape Canaveral, Florida',
              status: 'active',
              details: 'Historic Apollo and Space Shuttle launch pad',
              coordinates: [28.6080585, -80.6039558],
              timezone: 'America/New_York',
              launchAttempts: 180,
              launchSuccesses: 175
            },
            schedule: {
              launchTime: new Date(baseTime + 72 * 60 * 60 * 1000), // 3 days from now
              precision: 'exact',
              window: 120,
              autoSequenceStart: 'Enabled'
            },
            status: 'upcoming',
            media: {
              patch: null,
              patchLarge: null,
              images: [],
              webcast: 'https://www.youtube.com/spacex',
              article: null,
              wikipedia: 'https://en.wikipedia.org/wiki/Europa_Clipper',
              reddit: {
                campaign: null,
                launch: null,
                recovery: null
              }
            },
            mission: {
              type: 'NASA',
              flightNumber: 95,
              staticFireDate: new Date(baseTime + 48 * 60 * 60 * 1000),
              crew: [],
              ships: ['ASOG', 'ASDS JRTI'],
              capsules: [],
              cores: ['B1064', 'B1065', 'B1066']
            },
            source: 'spacex-fallback-enhanced',
            category: 'upcoming',
            lastUpdated: baseTime
          },
          {
            id: 'spacex-fallback-2',
            name: 'Starship IFT-5',
            description: 'Fifth integrated flight test of Starship and Super Heavy booster. This test will demonstrate orbital refueling capabilities, advanced landing procedures, and heat shield performance during atmospheric reentry.',
            agency: 'spacex',
            rocket: {
              name: 'Starship',
              type: 'super-heavy',
              reusable: true,
              stages: 2,
              boosters: 0,
              height: '120m',
              diameter: '9m',
              mass: '5,000,000kg',
              payloadToLEO: 150000,
              payloadToGTO: 0,
              firstFlight: '2023-04-20',
              successRate: 60.0,
              landingLegs: 6,
              engines: 39
            },
            payload: {
              name: 'Test Payload',
              type: 'test',
              mass: 0,
              orbit: 'Suborbital',
              customers: ['SpaceX'],
              manufacturers: ['SpaceX'],
              nationalities: ['United States']
            },
            launchSite: {
              name: 'Starbase Orbital Launch Mount',
              location: 'Boca Chica, Texas',
              status: 'active',
              details: 'SpaceX\'s private orbital launch facility',
              coordinates: [25.9972695, -97.1560896],
              timezone: 'America/Chicago',
              launchAttempts: 4,
              launchSuccesses: 2
            },
            schedule: {
              launchTime: new Date(baseTime + 30 * 24 * 60 * 60 * 1000), // 30 days from now
              precision: 'approximate',
              window: 60,
              autoSequenceStart: 'Manual'
            },
            status: 'upcoming',
            media: {
              patch: null,
              patchLarge: null,
              images: [],
              webcast: 'https://www.youtube.com/spacex',
              article: null,
              wikipedia: 'https://en.wikipedia.org/wiki/SpaceX_Starship',
              reddit: {
                campaign: null,
                launch: null,
                recovery: null
              }
            },
            mission: {
              type: 'Test Flight',
              flightNumber: 5,
              staticFireDate: new Date(baseTime + 25 * 24 * 60 * 60 * 1000),
              crew: [],
              ships: [],
              capsules: [],
              cores: ['B12', 'S30']
            },
            source: 'spacex-fallback-enhanced',
            category: 'upcoming',
            lastUpdated: baseTime
          },
          {
            id: 'spacex-fallback-3',
            name: 'Falcon 9  Starlink Group 6-70',
            description: 'SpaceX Starlink mission deploying 23 next-generation satellites to low Earth orbit. These satellites will expand global broadband coverage and improve service quality in underserved regions.',
            agency: 'spacex',
            rocket: {
              name: 'Falcon 9',
              type: 'medium-lift',
              reusable: true,
              stages: 2,
              boosters: 0,
              height: '70m',
              diameter: '3.7m',
              mass: '549,054kg',
              payloadToLEO: 22800,
              payloadToGTO: 8300,
              firstFlight: '2010-06-04',
              successRate: 98.7,
              landingLegs: 4,
              engines: 9
            },
            payload: {
              name: 'Starlink Group 6-70',
              type: 'satellite',
              mass: 17400,
              orbit: 'Low Earth Orbit',
              customers: ['SpaceX'],
              manufacturers: ['SpaceX'],
              nationalities: ['United States']
            },
            launchSite: {
              name: 'Cape Canaveral Space Force Station SLC-40',
              location: 'Cape Canaveral, Florida',
              status: 'active',
              details: 'SpaceX\'s primary East Coast launch facility',
              coordinates: [28.5618571, -80.577366],
              timezone: 'America/New_York',
              launchAttempts: 95,
              launchSuccesses: 94
            },
            schedule: {
              launchTime: new Date(baseTime + 18 * 60 * 60 * 1000), // 18 hours from now
              precision: 'exact',
              window: 240,
              autoSequenceStart: 'Enabled'
            },
            status: 'upcoming',
            media: {
              patch: null,
              patchLarge: null,
              images: [],
              webcast: 'https://www.youtube.com/spacex',
              article: null,
              wikipedia: 'https://en.wikipedia.org/wiki/Starlink',
              reddit: {
                campaign: null,
                launch: null,
                recovery: null
              }
            },
            mission: {
              type: 'Starlink',
              flightNumber: 285,
              staticFireDate: new Date(baseTime + 12 * 60 * 60 * 1000),
              crew: [],
              ships: ['ASDS JRTI'],
              capsules: [],
              cores: ['B1073-15']
            },
            source: 'spacex-fallback-enhanced',
            category: 'upcoming',
            lastUpdated: baseTime
          }
        ];
      }

      getSpaceXFallback() {
        return this.getEnhancedSpaceXFallback();
      }

      getEnhancedInternationalFallback() {
        const baseTime = Date.now();
        return [
          {
            id: 'intl-esa-ariane6',
            name: 'Ariane 6  Maiden Flight',
            description: 'First flight of Europe\'s new Ariane 6 rocket, demonstrating the capabilities of ESA\'s next-generation launch vehicle. This inaugural mission will deploy multiple satellites and test the rocket\'s performance.',
            agency: 'esa',
            rocket: {
              name: 'Ariane 6',
              type: 'heavy-lift',
              reusable: false,
              family: 'Ariane',
              variant: 'A62',
              height: '63m',
              diameter: '5.4m',
              stages: 2,
              leoCapacity: 21500,
              gtoCapacity: 11500,
              firstFlight: null,
              successfulLaunches: 0,
              totalLaunches: 0,
              successRate: 0,
              manufacturer: 'ArianeGroup',
              country: 'EUR'
            },
            payload: {
              name: 'Multiple Satellites',
              type: 'Commercial Satellites',
              description: 'Various commercial and institutional payloads',
              orbit: 'Geostationary Transfer Orbit',
              category: 'Commercial'
            },
            launchSite: {
              name: 'Kourou ELA-4',
              location: 'Kourou, French Guiana',
              country: 'GUF',
              coordinates: [5.236, -52.768],
              timezone: 'America/Cayenne',
              totalLaunches: 0,
              orbitalLaunches: 0,
              details: 'New launch pad built specifically for Ariane 6'
            },
            schedule: {
              launchTime: new Date(baseTime + 60 * 24 * 60 * 60 * 1000), // 60 days from now
              precision: 'approximate',
              window: 180,
              probability: 80
            },
            status: 'upcoming',
            media: {
              patch: null,
              images: [],
              webcast: 'https://www.esa.int/ESA_Multimedia/ESA_Web_TV',
              infoUrl: 'https://www.esa.int/Enabling_Support/Space_Transportation/Ariane_6',
              videoUrl: null
            },
            international: {
              agencyType: 'Government',
              agencyCountry: 'EUR',
              launchProvider: 'ESA/ArianeGroup',
              missionType: 'Commercial',
              isGovernment: true,
              isCommercial: false
            },
            source: 'international-fallback',
            lastUpdated: baseTime
          },
          {
            id: 'intl-isro-chandrayaan4',
            name: 'PSLV-C59  Chandrayaan-4',
            description: 'India\'s fourth lunar mission featuring an advanced sample return capability. This mission will demonstrate ISRO\'s growing capabilities in deep space exploration and lunar surface operations.',
            agency: 'isro',
            rocket: {
              name: 'PSLV-XL',
              type: 'medium-lift',
              reusable: false,
              family: 'PSLV',
              variant: 'XL',
              height: '44m',
              diameter: '2.8m',
              stages: 4,
              leoCapacity: 3800,
              gtoCapacity: 1750,
              firstFlight: '1993-09-20',
              successfulLaunches: 56,
              totalLaunches: 58,
              successRate: 96.6,
              manufacturer: 'ISRO',
              country: 'IND'
            },
            payload: {
              name: 'Chandrayaan-4 Orbiter & Lander',
              type: 'Lunar Mission',
              description: 'Advanced lunar orbiter and sample return lander',
              orbit: 'Lunar Transfer Orbit',
              category: 'Science'
            },
            launchSite: {
              name: 'Satish Dhawan Space Centre SHAR',
              location: 'Sriharikota, Andhra Pradesh',
              country: 'IND',
              coordinates: [13.72, 80.23],
              timezone: 'Asia/Kolkata',
              totalLaunches: 95,
              orbitalLaunches: 90,
              details: 'India\'s primary spaceport on the east coast'
            },
            schedule: {
              launchTime: new Date(baseTime + 180 * 24 * 60 * 60 * 1000), // 6 months from now
              precision: 'approximate',
              window: 240,
              probability: 90
            },
            status: 'upcoming',
            media: {
              patch: null,
              images: [],
              webcast: 'https://www.isro.gov.in/live',
              infoUrl: 'https://www.isro.gov.in/chandrayaan-4',
              videoUrl: null
            },
            international: {
              agencyType: 'Government',
              agencyCountry: 'IND',
              launchProvider: 'ISRO',
              missionType: 'Science',
              isGovernment: true,
              isCommercial: false
            },
            source: 'international-fallback',
            lastUpdated: baseTime
          },
          {
            id: 'intl-jaxa-hmx',
            name: 'H3  HTV-X Demo',
            description: 'Japan\'s new H3 rocket launching the HTV-X cargo vehicle demonstration mission to the International Space Station. This mission showcases JAXA\'s next-generation launch and cargo capabilities.',
            agency: 'jaxa',
            rocket: {
              name: 'H3-22S',
              type: 'medium-lift',
              reusable: false,
              family: 'H3',
              variant: '22S',
              height: '57m',
              diameter: '4m',
              stages: 2,
              leoCapacity: 22000,
              gtoCapacity: 6500,
              firstFlight: '2023-03-07',
              successfulLaunches: 2,
              totalLaunches: 3,
              successRate: 66.7,
              manufacturer: 'Mitsubishi Heavy Industries',
              country: 'JPN'
            },
            payload: {
              name: 'HTV-X Demonstration Vehicle',
              type: 'Cargo Vehicle',
              description: 'Next-generation cargo vehicle for ISS resupply',
              orbit: 'Low Earth Orbit',
              category: 'Government'
            },
            launchSite: {
              name: 'Tanegashima Space Center LA-Y2',
              location: 'Tanegashima Island, Japan',
              country: 'JPN',
              coordinates: [30.39, 130.97],
              timezone: 'Asia/Tokyo',
              totalLaunches: 48,
              orbitalLaunches: 45,
              details: 'Japan\'s primary launch facility in southern Kyushu'
            },
            schedule: {
              launchTime: new Date(baseTime + 90 * 24 * 60 * 60 * 1000), // 3 months from now
              precision: 'exact',
              window: 60,
              probability: 85
            },
            status: 'upcoming',
            media: {
              patch: null,
              images: [],
              webcast: 'https://www.jaxa.jp/live/',
              infoUrl: 'https://www.jaxa.jp/projects/rockets/h3/',
              videoUrl: null
            },
            international: {
              agencyType: 'Government',
              agencyCountry: 'JPN',
              launchProvider: 'JAXA',
              missionType: 'Government',
              isGovernment: true,
              isCommercial: false
            },
            source: 'international-fallback',
            lastUpdated: baseTime
          }
        ];
      }

      getLaunchLibraryFallback() {
        return this.getEnhancedInternationalFallback();
      }

      createEnhancedNASAMissions() {
        const baseTime = Date.now();
        return [
          {
            id: 'nasa-artemis-2',
            name: 'Artemis II  Lunar Flyby',
            description: 'First crewed mission around the Moon since Apollo 17. Four astronauts will fly around the Moon on a 10-day mission to test systems and procedures for future lunar landings as part of NASA\'s Artemis program.',
            agency: 'nasa',
            rocket: {
              name: 'Space Launch System (SLS)',
              type: 'super-heavy',
              reusable: false,
              family: 'Space Launch System',
              variant: 'Block 1',
              height: '98m',
              diameter: '8.4m',
              stages: 2,
              leoCapacity: 95000,
              gtoCapacity: 0,
              firstFlight: '2022-11-16',
              successfulLaunches: 1,
              totalLaunches: 1,
              successRate: 100.0,
              manufacturer: 'Boeing/Aerojet Rocketdyne',
              country: 'USA'
            },
            payload: {
              name: 'Orion Crew Capsule',
              type: 'Crewed Mission',
              description: 'Four-person crew capsule for lunar flyby mission',
              orbit: 'Lunar Trajectory',
              category: 'Crewed'
            },
            launchSite: {
              name: 'Kennedy Space Center LC-39B',
              location: 'Cape Canaveral, Florida',
              country: 'USA',
              coordinates: [28.6272, -80.6208],
              timezone: 'America/New_York',
              totalLaunches: 13,
              orbitalLaunches: 13,
              details: 'Historic Apollo and Space Shuttle launch pad'
            },
            schedule: {
              launchTime: new Date(baseTime + 120 * 24 * 60 * 60 * 1000), // 4 months from now
              precision: 'approximate',
              window: 120,
              probability: 85
            },
            status: 'upcoming',
            media: {
              patch: null,
              images: [],
              webcast: 'https://www.nasa.gov/live',
              infoUrl: 'https://www.nasa.gov/artemis-2',
              videoUrl: null
            },
            international: {
              agencyType: 'Government',
              agencyCountry: 'USA',
              launchProvider: 'NASA',
              missionType: 'Crewed',
              isGovernment: true,
              isCommercial: false
            },
            source: 'nasa-enhanced',
            lastUpdated: baseTime
          },
          {
            id: 'nasa-europa-clipper',
            name: 'Europa Clipper',
            description: 'NASA\'s flagship mission to Jupiter\'s moon Europa to investigate its subsurface ocean and assess its potential for harboring life. The spacecraft will conduct detailed reconnaissance of Europa\'s ice shell and underlying ocean.',
            agency: 'nasa',
            rocket: {
              name: 'Falcon Heavy',
              type: 'heavy-lift',
              reusable: true,
              family: 'Falcon',
              variant: 'Heavy',
              height: '70m',
              diameter: '3.66m',
              stages: 2,
              leoCapacity: 63800,
              gtoCapacity: 26700,
              firstFlight: '2018-02-06',
              successfulLaunches: 8,
              totalLaunches: 8,
              successRate: 100.0,
              manufacturer: 'SpaceX',
              country: 'USA'
            },
            payload: {
              name: 'Europa Clipper Spacecraft',
              type: 'Interplanetary Probe',
              description: 'Advanced spacecraft with nine scientific instruments',
              orbit: 'Jupiter System',
              category: 'Science'
            },
            launchSite: {
              name: 'Kennedy Space Center LC-39A',
              location: 'Cape Canaveral, Florida',
              country: 'USA',
              coordinates: [28.6080585, -80.6039558],
              timezone: 'America/New_York',
              totalLaunches: 180,
              orbitalLaunches: 175,
              details: 'Historic Apollo and Space Shuttle launch pad'
            },
            schedule: {
              launchTime: new Date(baseTime + 45 * 24 * 60 * 60 * 1000), // 45 days from now
              precision: 'exact',
              window: 21,
              probability: 95
            },
            status: 'upcoming',
            media: {
              patch: null,
              images: [],
              webcast: 'https://www.nasa.gov/live',
              infoUrl: 'https://www.nasa.gov/europa-clipper',
              videoUrl: null
            },
            international: {
              agencyType: 'Government',
              agencyCountry: 'USA',
              launchProvider: 'NASA',
              missionType: 'Science',
              isGovernment: true,
              isCommercial: false
            },
            source: 'nasa-enhanced',
            lastUpdated: baseTime
          }
        ];
      }

      getEnhancedNASAFallback() {
        return this.createEnhancedNASAMissions();
      }

      getNASAFallback() {
        return this.getEnhancedNASAFallback();
      }

      getFallbackData() {
        console.log(' Using fallback launch data');
        return this.fallbackData;
      }

      // Public API methods
      async refreshData() {
        return await this.fetchAllLaunches();
      }

      getStatistics() {
        const launches = Array.from(this.launches.values());
        const agencies = new Set(launches.map(l => l.agency));
        const upcoming = launches.filter(l => l.status === 'upcoming').length;
        const live = launches.filter(l => l.status === 'live').length;
        const recent = launches.filter(l => ['success', 'failure'].includes(l.status)).length;
        
        return {
          total: launches.length,
          upcoming,
          live,
          recent,
          agencies: agencies.size,
          lastUpdate: this.lastUpdate
        };
      }

      isDataFresh() {
        const age = Date.now() - this.lastUpdate;
        return age < this.updateInterval;
      }

      // SpaceX-specific analytics and statistics
      getSpaceXStatistics() {
        const spaceXLaunches = Array.from(this.launches.values()).filter(l => l.agency === 'spacex');
        
        const rocketTypes = {};
        const missionTypes = {};
        let totalMass = 0;
        let reuseCount = 0;
        
        spaceXLaunches.forEach(launch => {
          // Rocket type statistics
          const rocketType = launch.rocket.name;
          rocketTypes[rocketType] = (rocketTypes[rocketType] || 0) + 1;
          
          // Mission type statistics
          const missionType = launch.mission?.type || 'Commercial';
          missionTypes[missionType] = (missionTypes[missionType] || 0) + 1;
          
          // Payload mass
          totalMass += launch.payload.mass || 0;
          
          // Reusability
          if (launch.rocket.reusable) reuseCount++;
        });

        return {
          totalLaunches: spaceXLaunches.length,
          rocketTypes,
          missionTypes,
          totalPayloadMass: totalMass,
          reusePercentage: spaceXLaunches.length > 0 ? (reuseCount / spaceXLaunches.length * 100).toFixed(1) : 0,
          upcomingLaunches: spaceXLaunches.filter(l => l.status === 'upcoming').length,
          successfulLaunches: spaceXLaunches.filter(l => l.status === 'success').length,
          averageSuccessRate: this.calculateAverageSpaceXSuccessRate(spaceXLaunches)
        };
      }

      calculateAverageSpaceXSuccessRate(launches) {
        if (launches.length === 0) return 0;
        
        const rocketSuccessRates = launches.map(launch => launch.rocket.successRate || 95);
        const average = rocketSuccessRates.reduce((sum, rate) => sum + rate, 0) / rocketSuccessRates.length;
        return average.toFixed(1);
      }

      getSpaceXUpcomingByRocket() {
        const spaceXLaunches = this.filterByCategory('spacex').filter(l => l.status === 'upcoming');
        const byRocket = {};
        
        spaceXLaunches.forEach(launch => {
          const rocket = launch.rocket.name;
          if (!byRocket[rocket]) byRocket[rocket] = [];
          byRocket[rocket].push(launch);
        });
        
        return byRocket;
      }

      getNextSpaceXLaunch() {
        const spaceXLaunches = this.filterByCategory('spacex')
          .filter(l => l.status === 'upcoming')
          .sort((a, b) => new Date(a.schedule.launchTime) - new Date(b.schedule.launchTime));
        
        return spaceXLaunches[0] || null;
      }

      getSpaceXLaunchHistory(days = 30) {
        const cutoffDate = new Date(Date.now() - days * 24 * 60 * 60 * 1000);
        return Array.from(this.launches.values())
          .filter(l => l.agency === 'spacex' && new Date(l.schedule.launchTime) >= cutoffDate)
          .sort((a, b) => new Date(b.schedule.launchTime) - new Date(a.schedule.launchTime));
      }

      // International space agency statistics
      getInternationalStatistics() {
        const internationalLaunches = Array.from(this.launches.values())
          .filter(l => !['spacex', 'nasa'].includes(l.agency));
        
        const agencyStats = {};
        const countryStats = {};
        const missionTypes = {};
        let totalInternationalMass = 0;
        
        internationalLaunches.forEach(launch => {
          // Agency statistics
          const agency = launch.agency;
          agencyStats[agency] = (agencyStats[agency] || 0) + 1;
          
          // Country statistics
          const country = launch.international?.agencyCountry || 'Unknown';
          countryStats[country] = (countryStats[country] || 0) + 1;
          
          // Mission type statistics
          const missionType = launch.international?.missionType || 'Unknown';
          missionTypes[missionType] = (missionTypes[missionType] || 0) + 1;
          
          // Payload mass
          totalInternationalMass += launch.payload?.mass || 0;
        });

        return {
          totalLaunches: internationalLaunches.length,
          agencyBreakdown: agencyStats,
          countryBreakdown: countryStats,
          missionTypeBreakdown: missionTypes,
          totalPayloadMass: totalInternationalMass,
          governmentLaunches: internationalLaunches.filter(l => l.international?.isGovernment).length,
          commercialLaunches: internationalLaunches.filter(l => l.international?.isCommercial).length,
          upcomingInternational: internationalLaunches.filter(l => l.status === 'upcoming').length
        };
      }

      getAgencyStatistics(agency) {
        const agencyLaunches = Array.from(this.launches.values()).filter(l => l.agency === agency);
        
        if (agencyLaunches.length === 0) {
          return { totalLaunches: 0, upcomingLaunches: 0, successRate: 0 };
        }

        const successful = agencyLaunches.filter(l => l.status === 'success').length;
        const upcoming = agencyLaunches.filter(l => l.status === 'upcoming').length;
        const total = agencyLaunches.length;
        
        return {
          totalLaunches: total,
          upcomingLaunches: upcoming,
          successfulLaunches: successful,
          successRate: total > 0 ? ((successful / total) * 100).toFixed(1) : 0,
          averagePayloadMass: agencyLaunches.reduce((sum, l) => sum + (l.payload?.mass || 0), 0) / total,
          mostCommonRocket: this.getMostCommonRocket(agencyLaunches),
          recentLaunches: agencyLaunches
            .filter(l => new Date(l.schedule.launchTime) > new Date(Date.now() - 90 * 24 * 60 * 60 * 1000))
            .length
        };
      }

      getMostCommonRocket(launches) {
        const rocketCounts = {};
        launches.forEach(launch => {
          const rocket = launch.rocket?.name || 'Unknown';
          rocketCounts[rocket] = (rocketCounts[rocket] || 0) + 1;
        });
        
        return Object.entries(rocketCounts)
          .sort(([,a], [,b]) => b - a)[0]?.[0] || 'Unknown';
      }

      getGlobalLaunchTrends() {
        const launches = Array.from(this.launches.values());
        const currentYear = new Date().getFullYear();
        
        const yearlyStats = {};
        const monthlyStats = {};
        
        launches.forEach(launch => {
          const launchDate = new Date(launch.schedule.launchTime);
          const year = launchDate.getFullYear();
          const month = launchDate.getMonth();
          
          if (year >= currentYear - 2) { // Last 3 years
            yearlyStats[year] = (yearlyStats[year] || 0) + 1;
            
            const monthKey = `${year}-${month.toString().padStart(2, '0')}`;
            monthlyStats[monthKey] = (monthlyStats[monthKey] || 0) + 1;
          }
        });

        return {
          yearlyTrends: yearlyStats,
          monthlyTrends: monthlyStats,
          totalAgencies: new Set(launches.map(l => l.agency)).size,
          totalCountries: new Set(launches.map(l => l.international?.agencyCountry).filter(Boolean)).size,
          averageLaunchesPerMonth: Object.values(monthlyStats).reduce((sum, count) => sum + count, 0) / Object.keys(monthlyStats).length || 0
        };
      }
    }

    // Initialize global launch data manager
    const launchDataManager = new LaunchDataManager();

    // Legacy function for compatibility
    function animateCountdowns() {
      // This function is now handled by CountdownManager
      if (!window.countdownManagerInitialized) {
        countdownManager.init();
        window.countdownManagerInitialized = true;
      }
    }

    // Comprehensive Mission Detail Modal Functions
    function openMissionModal(button) {
      const card = button.closest('.launch-card');
      const missionData = extractMissionData(card);
      
      // Add visual feedback
      button.style.transform = 'scale(0.95)';
      setTimeout(() => {
        button.style.transform = '';
      }, 150);
      
      // Populate modal with mission data
      populateMissionModal(missionData);
      
      // Show modal with animation
      const modal = document.getElementById('mission-modal');
      modal.classList.add('visible');
      document.body.style.overflow = 'hidden';
      
      // Start modal countdown if mission is upcoming
      if (missionData.launchTime) {
        startModalCountdown(missionData.launchTime);
      }
      
      console.log(`Opened comprehensive modal for: ${missionData.name}`);
    }

    function extractMissionData(card) {
      const missionName = card.querySelector('.mission-name')?.textContent || 'Unknown Mission';
      const agencyName = card.querySelector('.agency-name')?.textContent || 'Unknown Agency';
      const launchDate = card.querySelector('.launch-date')?.textContent || 'TBD';
      const launchTime = card.querySelector('.launch-time')?.textContent || 'TBD';
      const status = card.querySelector('.launch-status')?.textContent || 'Unknown';
      const agencyLogo = card.querySelector('.agency-logo')?.src || '';
      const missionPatch = card.querySelector('.mission-patch')?.src || '';
      
      // Extract additional data from data attributes or generate realistic data
      return {
        name: missionName,
        subtitle: generateMissionSubtitle(missionName),
        agency: agencyName,
        agencyLogo: agencyLogo,
        missionPatch: missionPatch,
        launchDate: launchDate,
        launchTime: launchTime,
        status: status,
        objectives: generateMissionObjectives(missionName),
        rocket: generateRocketData(missionName),
        timeline: generateMissionTimeline(missionName),
        stats: generateMissionStats(missionName),
        media: generateMissionMedia(missionName)
      };
    }

    function populateMissionModal(data) {
      // Header section
      document.getElementById('modal-mission-name').textContent = data.name;
      document.getElementById('modal-mission-subtitle').textContent = data.subtitle;
      document.getElementById('modal-agency-name').textContent = data.agency;
      
      // Set images with fallbacks
      const missionPatch = document.getElementById('modal-mission-patch');
      const agencyLogo = document.getElementById('modal-agency-logo');
      
      if (data.missionPatch) {
        missionPatch.src = data.missionPatch;
        missionPatch.style.display = 'block';
        missionPatch.parentElement.querySelector('.patch-placeholder').style.display = 'none';
      } else {
        missionPatch.style.display = 'none';
        missionPatch.parentElement.querySelector('.patch-placeholder').style.display = 'flex';
      }
      
      if (data.agencyLogo) {
        agencyLogo.src = data.agencyLogo;
      }
      
      // Overview tab
      document.getElementById('modal-mission-objectives').textContent = data.objectives;
      
      // Stats
      document.getElementById('modal-mission-cost').textContent = data.stats.cost;
      document.getElementById('modal-mission-duration').textContent = data.stats.duration;
      document.getElementById('modal-payload-mass').textContent = data.stats.payloadMass;
      document.getElementById('modal-success-rate').textContent = data.stats.successRate;
      
      // Rocket tab
      document.getElementById('modal-rocket-name').textContent = data.rocket.name;
      populateRocketSpecs(data.rocket.specs);
      
      // Timeline tab
      populateTimeline(data.timeline);
      
      // Media tab
      populateMediaGallery(data.media);
      
      // Update action buttons
      updateModalActions(data);
    }

    function generateMissionSubtitle(missionName) {
      const subtitles = {
        'Starship IFT-6': 'Integrated Flight Test - Advancing Human Spaceflight',
        'Falcon 9': 'Reliable Workhorse - Commercial Satellite Deployment',
        'Artemis II': 'Return to the Moon - Crewed Lunar Flyby Mission',
        'Europa Clipper': 'Exploring Jupiter\'s Icy Moon for Signs of Life',
        'JWST': 'Next Generation Space Telescope - Unlocking Cosmic Mysteries'
      };
      
      return subtitles[missionName] || 'Advanced Space Mission - Pushing the Boundaries of Exploration';
    }

    function generateMissionObjectives(missionName) {
      const objectives = {
        'Starship IFT-6': 'Demonstrate in-flight engine relight, test heat shield performance during reentry, validate landing procedures for future crewed missions, and advance propellant transfer capabilities.',
        'Falcon 9': 'Deploy commercial satellites to their designated orbits, demonstrate continued reliability of reusable rocket technology, and maintain SpaceX\'s industry-leading launch cadence.',
        'Artemis II': 'Conduct the first crewed lunar flyby since Apollo 17, test life support systems in deep space, validate Orion spacecraft performance, and prepare for future lunar surface missions.',
        'Europa Clipper': 'Study Europa\'s subsurface ocean, analyze the moon\'s ice shell and geology, search for signs of habitability, and assess the potential for life in Jupiter\'s system.',
        'JWST': 'Observe the most distant galaxies in the universe, study exoplanet atmospheres, investigate star and planet formation, and revolutionize our understanding of cosmic evolution.'
      };
      
      return objectives[missionName] || 'Advance scientific knowledge and technological capabilities through innovative space exploration, contributing to humanity\'s understanding of the universe and our place within it.';
    }

    function generateRocketData(missionName) {
      const rockets = {
        'Starship IFT-6': {
          name: 'Starship Super Heavy',
          specs: {
            'Height': '120 m (394 ft)',
            'Diameter': '9 m (30 ft)',
            'Mass': '5,000,000 kg',
            'Stages': '2 (Super Heavy + Starship)',
            'Engines': '33 Raptor (1st stage), 6 Raptor (2nd stage)',
            'Payload to LEO': '100,000+ kg',
            'Payload to Mars': '100,000+ kg',
            'First Flight': '2023',
            'Reusable': 'Fully Reusable',
            'Fuel': 'Liquid Methane + Liquid Oxygen'
          }
        },
        'Falcon 9': {
          name: 'Falcon 9 Block 5',
          specs: {
            'Height': '70 m (230 ft)',
            'Diameter': '3.7 m (12 ft)',
            'Mass': '549,054 kg',
            'Stages': '2',
            'Engines': '9 Merlin 1D (1st stage), 1 Merlin 1D Vacuum (2nd stage)',
            'Payload to LEO': '22,800 kg',
            'Payload to GTO': '8,300 kg',
            'First Flight': '2018 (Block 5)',
            'Success Rate': '98.9%',
            'Reusable': 'First Stage',
            'Fuel': 'RP-1 + Liquid Oxygen'
          }
        }
      };
      
      return rockets[missionName] || {
        name: 'Advanced Launch Vehicle',
        specs: {
          'Height': '65 m (213 ft)',
          'Diameter': '4.0 m (13 ft)',
          'Mass': '450,000 kg',
          'Stages': '2',
          'Engines': 'Multiple High-Performance Engines',
          'Payload to LEO': '15,000 kg',
          'Payload to GTO': '6,000 kg',
          'First Flight': '2024',
          'Success Rate': '95%+',
          'Reusable': 'Partially Reusable'
        }
      };
    }

    function generateMissionTimeline(missionName) {
      return [
        { time: 'T-24:00:00', event: 'Final Launch Preparations Begin', status: 'completed' },
        { time: 'T-04:00:00', event: 'Propellant Loading Starts', status: 'completed' },
        { time: 'T-00:35:00', event: 'Launch Director Go/No-Go Poll', status: 'active' },
        { time: 'T-00:10:00', event: 'Final Automated Checks', status: 'pending' },
        { time: 'T-00:00:00', event: 'LIFTOFF!', status: 'pending' },
        { time: 'T+00:02:30', event: 'Max Q (Maximum Aerodynamic Pressure)', status: 'pending' },
        { time: 'T+00:08:00', event: 'First Stage Separation', status: 'pending' },
        { time: 'T+00:09:00', event: 'Second Stage Engine Ignition', status: 'pending' },
        { time: 'T+00:45:00', event: 'Payload Deployment', status: 'pending' }
      ];
    }

    function generateMissionStats(missionName) {
      const stats = {
        'Starship IFT-6': {
          cost: '$3B+',
          duration: '90 min',
          payloadMass: '0 kg (Test)',
          successRate: '40%'
        },
        'Falcon 9': {
          cost: '$67M',
          duration: '15 min',
          payloadMass: '15,600 kg',
          successRate: '98.9%'
        }
      };
      
      return stats[missionName] || {
        cost: '$150M',
        duration: '45 min',
        payloadMass: '8,500 kg',
        successRate: '95%'
      };
    }

    function generateMissionMedia(missionName) {
      return {
        images: [
          { url: 'https://via.placeholder.com/300x200/0033A0/FFFFFF?text=Launch+Pad', caption: 'Launch Pad Preparation' },
          { url: 'https://via.placeholder.com/300x200/FF4444/FFFFFF?text=Rocket+Assembly', caption: 'Rocket Assembly' },
          { url: 'https://via.placeholder.com/300x200/00AA44/FFFFFF?text=Payload+Integration', caption: 'Payload Integration' }
        ],
        videos: [
          { url: '#', title: 'Mission Overview Video' },
          { url: '#', title: 'Rocket Assembly Timelapse' }
        ],
        links: [
          { url: '#', title: 'Official Mission Page', icon: '' },
          { url: '#', title: 'Live Stream', icon: '' },
          { url: '#', title: 'Mission Press Kit', icon: '' }
        ]
      };
    }

    function populateRocketSpecs(specs) {
      const table = document.querySelector('#modal-rocket-specs tbody');
      table.innerHTML = '';
      
      Object.entries(specs).forEach(([key, value]) => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${key}</td><td>${value}</td>`;
        table.appendChild(row);
      });
    }

    function populateTimeline(timeline) {
      const container = document.getElementById('modal-timeline');
      container.innerHTML = '<h3>Mission Timeline</h3>';
      
      timeline.forEach(item => {
        const timelineItem = document.createElement('div');
        timelineItem.className = `timeline-item ${item.status}`;
        timelineItem.innerHTML = `
          <div class="timeline-content">
            <h4>${item.event}</h4>
            <p class="timeline-time">${item.time}</p>
          </div>
        `;
        container.appendChild(timelineItem);
      });
    }

    function populateMediaGallery(media) {
      const gallery = document.getElementById('modal-media-gallery');
      gallery.innerHTML = `
        <h3>Mission Media</h3>
        <div class="media-grid">
          ${media.images.map(img => `
            <div class="media-item">
              <img src="${img.url}" alt="${img.caption}" loading="lazy">
              <div class="media-caption">${img.caption}</div>
            </div>
          `).join('')}
        </div>
        <div class="media-links">
          <h4>External Links</h4>
          <div class="link-grid">
            ${media.links.map(link => `
              <a href="${link.url}" class="media-link" target="_blank">
                <span class="link-icon">${link.icon}</span>
                <span class="link-title">${link.title}</span>
              </a>
            `).join('')}
          </div>
        </div>
      `;
    }

    function updateModalActions(data) {
      const primaryAction = document.getElementById('modal-primary-action');
      const streamAction = document.getElementById('modal-stream-action');
      const shareAction = document.getElementById('modal-share-action');
      
      // Update based on mission status
      if (data.status === 'Live') {
        primaryAction.innerHTML = ' Watch Live';
        primaryAction.onclick = () => watchLiveLaunch(data);
      } else {
        primaryAction.innerHTML = ' Set Launch Alert';
        primaryAction.onclick = () => setLaunchNotification(data);
      }
      
      streamAction.onclick = () => openLiveStream(data);
      shareAction.onclick = () => shareMissionModal(data);
    }

    function switchModalTab(tabName) {
      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Remove active class from all tab buttons
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Show selected tab content
      document.getElementById(`${tabName}-tab`).classList.add('active');
      
      // Add active class to selected tab button
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
    }

    function closeMissionModal() {
      const modal = document.getElementById('mission-modal');
      modal.classList.remove('visible');
      document.body.style.overflow = '';
      
      // Stop any running countdowns
      if (window.modalCountdownInterval) {
        clearInterval(window.modalCountdownInterval);
      }
    }

    function startModalCountdown(launchTime) {
      // Clear any existing countdown
      if (window.modalCountdownInterval) {
        clearInterval(window.modalCountdownInterval);
      }
      
      // Parse launch time (assuming format like "Dec 15, 2024 10:30 AM EST")
      const targetDate = new Date(launchTime).getTime();
      
      if (isNaN(targetDate)) {
        // If we can't parse the date, show placeholder
        updateModalCountdownDisplay('--', '--', '--', '--');
        return;
      }
      
      window.modalCountdownInterval = setInterval(() => {
        const now = new Date().getTime();
        const distance = targetDate - now;
        
        if (distance < 0) {
          updateModalCountdownDisplay('00', '00', '00', '00');
          clearInterval(window.modalCountdownInterval);
          return;
        }
        
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
        updateModalCountdownDisplay(
          days.toString().padStart(2, '0'),
          hours.toString().padStart(2, '0'),
          minutes.toString().padStart(2, '0'),
          seconds.toString().padStart(2, '0')
        );
      }, 1000);
    }

    function updateModalCountdownDisplay(days, hours, minutes, seconds) {
      const countdowns = ['modal-countdown', 'modal-footer-countdown'];
      
      countdowns.forEach(countdownId => {
        const countdown = document.getElementById(countdownId);
        if (countdown) {
          const timeUnits = countdown.querySelectorAll('.time-unit .number');
          if (timeUnits.length >= 4) {
            timeUnits[0].textContent = days;
            timeUnits[1].textContent = hours;
            timeUnits[2].textContent = minutes;
            timeUnits[3].textContent = seconds;
          }
        }
      });
    }

    // Modal Action Functions
    function watchLiveLaunch(data) {
      showNotification(`Opening live stream for ${data.name}! `, 'success');
      // In a real implementation, this would open the live stream
      window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank');
    }

    function setLaunchNotification(data) {
      showNotification(`Launch alert set for ${data.name}! `, 'success');
      // In a real implementation, this would set up browser notifications
    }

    function openLiveStream(data) {
      showNotification(`Opening live stream for ${data.name}! `, 'info');
      // In a real implementation, this would open the appropriate live stream
    }

    function shareMissionModal(data) {
      if (navigator.share) {
        navigator.share({
          title: `${data.name} - BlueandCosmos`,
          text: `Check out this space mission: ${data.name}`,
          url: window.location.href
        });
      } else {
        navigator.clipboard.writeText(`${data.name} - ${window.location.href}`);
        showNotification('Mission link copied to clipboard! ', 'success');
      }
    }

    function downloadMissionData(data) {
      showNotification(`Downloading mission data for ${data.name}! `, 'info');
      // In a real implementation, this would generate and download mission data
    }

    // Close modal when clicking outside
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal-overlay')) {
        closeMissionModal();
      }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && document.getElementById('mission-modal').classList.contains('visible')) {
        closeMissionModal();
      }
    });

    function setNotification(button) {
      const card = button.closest('.launch-card');
      const missionName = card.querySelector('.mission-name').textContent;
      
      // Add visual feedback
      button.style.transform = 'scale(0.95)';
      setTimeout(() => {
        button.style.transform = '';
      }, 150);
      
      console.log(`Setting notification for: ${missionName}`);
      showNotification(`Notification set for ${missionName}! `, 'success');
    }

    function shareLaunch(button) {
      const card = button.closest('.launch-card');
      const missionName = card.querySelector('.mission-name').textContent;
      
      // Add visual feedback
      button.style.transform = 'scale(0.95)';
      setTimeout(() => {
        button.style.transform = '';
      }, 150);
      
      console.log(`Sharing: ${missionName}`);
      
      // Simple share functionality
      if (navigator.share) {
        navigator.share({
          title: `${missionName} - BlueandCosmos`,
          text: `Check out this upcoming space launch: ${missionName}`,
          url: window.location.href
        });
      } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(`${missionName} - ${window.location.href}`);
        showNotification('Launch link copied to clipboard! ', 'success');
      }
    }

    // Launch Data UI Updates
    function updateLaunchGrid() {
      if (!window.launchDataManager) return;
      
      const launches = launchDataManager.getUpcomingLaunches(6);
      const launchGrid = document.getElementById('launch-grid');
      
      if (launches.length === 0) {
        console.log('No launch data available, keeping placeholder cards');
        return;
      }
      
      // Update existing cards with real data
      const existingCards = launchGrid.querySelectorAll('.launch-card');
      
      launches.forEach((launch, index) => {
        if (index < existingCards.length) {
          updateLaunchCard(existingCards[index], launch);
        }
      });
      
      console.log(` Updated ${Math.min(launches.length, existingCards.length)} launch cards with real data`);
    }

    function updateLaunchCard(cardElement, launchData) {
      // Update agency badge
      const agencyBadge = cardElement.querySelector('.agency-badge');
      const agencyName = cardElement.querySelector('.agency-name');
      if (agencyBadge && agencyName) {
        agencyBadge.className = `agency-badge ${launchData.agency}`;
        agencyName.textContent = getAgencyDisplayName(launchData.agency);
      }

      // Update status
      const statusElement = cardElement.querySelector('.launch-status');
      if (statusElement) {
        statusElement.className = `launch-status status-${launchData.status}`;
        statusElement.textContent = launchData.status.charAt(0).toUpperCase() + launchData.status.slice(1);
      }

      // Update mission info
      const missionName = cardElement.querySelector('.mission-name');
      const missionDescription = cardElement.querySelector('.mission-description');
      if (missionName) missionName.textContent = launchData.name;
      if (missionDescription) missionDescription.textContent = launchData.description;

      // Update launch details with enhanced SpaceX information
      const detailItems = cardElement.querySelectorAll('.detail-item');
      if (detailItems.length >= 4) {
        // Enhanced rocket information for SpaceX
        if (launchData.agency === 'spacex' && launchData.rocket.successRate) {
          detailItems[0].querySelector('.detail-value').textContent = 
            `${launchData.rocket.name} (${launchData.rocket.successRate}% success)`;
        } else {
          detailItems[0].querySelector('.detail-value').textContent = launchData.rocket.name;
        }
        
        detailItems[1].querySelector('.detail-value').textContent = launchData.launchSite.name;
        detailItems[2].querySelector('.detail-value').textContent = formatLaunchTime(launchData.schedule.launchTime);
        
        // Enhanced payload information
        if (launchData.payload.mass > 0) {
          detailItems[3].querySelector('.detail-value').textContent = 
            `${launchData.payload.name} (${launchData.payload.mass.toLocaleString()}kg)`;
        } else {
          detailItems[3].querySelector('.detail-value').textContent = launchData.payload.name;
        }
      }

      // Add SpaceX-specific mission type indicator
      if (launchData.agency === 'spacex' && launchData.mission?.type) {
        const missionTypeIndicator = cardElement.querySelector('.mission-type-indicator') || 
          document.createElement('div');
        missionTypeIndicator.className = 'mission-type-indicator';
        missionTypeIndicator.textContent = launchData.mission.type;
        missionTypeIndicator.style.cssText = `
          position: absolute;
          top: 10px;
          right: 10px;
          background: rgba(0, 82, 136, 0.8);
          color: white;
          padding: 0.2em 0.5em;
          border-radius: 12px;
          font-size: 0.7em;
          font-weight: 600;
        `;
        
        if (!cardElement.querySelector('.mission-type-indicator')) {
          cardElement.style.position = 'relative';
          cardElement.appendChild(missionTypeIndicator);
        }
      }

      // Update countdown timer
      const countdownTimer = cardElement.querySelector('.countdown-timer');
      if (countdownTimer) {
        countdownTimer.setAttribute('data-launch-time', launchData.schedule.launchTime.toISOString());
        countdownTimer.setAttribute('data-precision', launchData.schedule.precision);
      }

      // Update card data attributes
      cardElement.setAttribute('data-agency', launchData.agency);
      cardElement.setAttribute('data-status', launchData.status);
      cardElement.setAttribute('data-launch-id', launchData.id);
      
      // Add enhanced data attributes for SpaceX
      if (launchData.agency === 'spacex') {
        cardElement.setAttribute('data-rocket-type', launchData.rocket.type);
        cardElement.setAttribute('data-mission-type', launchData.mission?.type || 'Commercial');
        cardElement.setAttribute('data-flight-number', launchData.mission?.flightNumber || 0);
      }
    }

    function updateDashboardStats() {
      if (!window.launchDataManager) return;
      
      const stats = launchDataManager.getStatistics();
      const spaceXStats = launchDataManager.getSpaceXStatistics();
      const statCards = document.querySelectorAll('.stat-card');
      
      if (statCards.length >= 4) {
        // Update stat numbers with enhanced SpaceX data
        statCards[0].querySelector('.stat-number').textContent = stats.upcoming;
        statCards[1].querySelector('.stat-number').textContent = `${spaceXStats.averageSuccessRate}%`;
        statCards[2].querySelector('.stat-number').textContent = stats.agencies;
        statCards[3].querySelector('.stat-number').textContent = stats.total;
        
        // Update labels to match real data
        statCards[0].querySelector('.stat-label').textContent = 'Upcoming Launches';
        statCards[1].querySelector('.stat-label').textContent = 'SpaceX Success Rate';
        statCards[2].querySelector('.stat-label').textContent = 'Active Agencies';
        statCards[3].querySelector('.stat-label').textContent = 'Total Tracked';
        
        // Update change indicators with SpaceX-specific data
        const changeElements = document.querySelectorAll('.stat-change');
        if (changeElements.length >= 4) {
          changeElements[0].textContent = `+${stats.upcoming} this month`;
          changeElements[1].textContent = `${spaceXStats.reusePercentage}% reusable`;
          changeElements[2].textContent = `${spaceXStats.totalLaunches} SpaceX launches`;
          changeElements[3].textContent = `${Math.round(spaceXStats.totalPayloadMass / 1000)}t payload mass`;
        }
      }
      
      console.log(' Updated dashboard statistics:', stats);
      console.log(' SpaceX statistics:', spaceXStats);
    }

    function getAgencyDisplayName(agency) {
      const names = {
        'spacex': 'SpaceX',
        'nasa': 'NASA',
        'blue-origin': 'Blue Origin',
        'esa': 'ESA',
        'isro': 'ISRO',
        'cnsa': 'CNSA',
        'roscosmos': 'Roscosmos',
        'jaxa': 'JAXA',
        'csa': 'CSA',
        'international': 'International'
      };
      return names[agency] || agency.toUpperCase();
    }

    function formatLaunchTime(launchTime) {
      const date = new Date(launchTime);
      const options = { 
        month: 'short', 
        day: 'numeric', 
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        timeZoneName: 'short'
      };
      return date.toLocaleDateString('en-US', options);
    }

    // Advanced Filtering and Search System
    class FilterManager {
      constructor() {
        this.activeFilters = {
          agency: 'all',
          status: 'all',
          missionType: 'all',
          rocketType: 'all',
          country: 'all'
        };
        this.searchQuery = '';
        this.sortBy = 'launchTime';
        this.sortOrder = 'asc';
        this.resultsPerPage = 6;
        this.currentPage = 1;
        this.animationDuration = 300;
      }

      init() {
        this.setupFilterEventListeners();
        this.setupSearchEventListeners();
        this.setupSortingControls();
        this.loadFilterStateFromURL();
        console.log(' Advanced Filter Manager initialized');
      }

      setupFilterEventListeners() {
        // Enhanced filter button handling
        const filterButtons = document.querySelectorAll('.filter-btn');
        filterButtons.forEach(btn => {
          btn.addEventListener('click', (e) => {
            const filterType = e.target.dataset.filter;
            const filterCategory = e.target.dataset.category || 'agency';
            
            this.setFilter(filterCategory, filterType);
            this.updateFilterUI(filterCategory, filterType);
            this.applyFilters();
          });
        });

        // View control buttons
        const viewButtons = document.querySelectorAll('.view-btn');
        viewButtons.forEach(btn => {
          btn.addEventListener('click', (e) => {
            const viewType = e.target.dataset.view;
            this.setFilter('status', viewType === 'upcoming' ? 'upcoming' : 
                                   viewType === 'live' ? 'live' : 
                                   viewType === 'recent' ? 'recent' : 'all');
            this.updateViewUI(viewType);
            this.applyFilters();
          });
        });
      }

      setupSearchEventListeners() {
        const searchInput = document.getElementById('mission-search');
        const searchBtn = document.querySelector('.search-btn');
        
        if (searchInput) {
          // Real-time search with debouncing
          let searchTimeout;
          searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
              this.searchQuery = e.target.value.trim();
              this.applyFilters();
              this.updateURL();
            }, 300);
          });

          // Search on Enter key
          searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              this.searchQuery = e.target.value.trim();
              this.applyFilters();
              this.updateURL();
            }
          });
        }

        if (searchBtn) {
          searchBtn.addEventListener('click', () => {
            if (searchInput) {
              this.searchQuery = searchInput.value.trim();
              this.applyFilters();
              this.updateURL();
            }
          });
        }
      }

      setupSortingControls() {
        // Add sorting dropdown if it doesn't exist
        this.createSortingControls();
      }

      createSortingControls() {
        const controlsBar = document.querySelector('.controls-bar');
        if (!controlsBar || document.querySelector('.sort-controls')) return;

        const sortControls = document.createElement('div');
        sortControls.className = 'sort-controls';
        sortControls.innerHTML = `
          <select class="sort-select" id="sort-select">
            <option value="launchTime-asc">Launch Time (Earliest)</option>
            <option value="launchTime-desc">Launch Time (Latest)</option>
            <option value="name-asc">Mission Name (A-Z)</option>
            <option value="name-desc">Mission Name (Z-A)</option>
            <option value="agency-asc">Agency (A-Z)</option>
            <option value="rocket-asc">Rocket (A-Z)</option>
          </select>
        `;

        controlsBar.appendChild(sortControls);

        const sortSelect = document.getElementById('sort-select');
        sortSelect.addEventListener('change', (e) => {
          const [sortBy, sortOrder] = e.target.value.split('-');
          this.sortBy = sortBy;
          this.sortOrder = sortOrder;
          this.applyFilters();
          this.updateURL();
        });
      }

      setFilter(category, value) {
        this.activeFilters[category] = value;
        this.currentPage = 1; // Reset to first page when filtering
      }

      updateFilterUI(category, value) {
        // Update filter button states
        const categoryButtons = document.querySelectorAll(`[data-category="${category}"], .filter-btn, .view-btn`);
        categoryButtons.forEach(btn => {
          btn.classList.remove('active');
          if (btn.dataset.filter === value || btn.dataset.view === value) {
            btn.classList.add('active');
          }
        });

        // Add visual feedback
        const activeButton = document.querySelector(`[data-filter="${value}"], [data-view="${value}"]`);
        if (activeButton) {
          activeButton.style.transform = 'scale(0.95)';
          setTimeout(() => {
            activeButton.style.transform = '';
          }, 150);
        }
      }

      updateViewUI(viewType) {
        const viewButtons = document.querySelectorAll('.view-btn');
        viewButtons.forEach(btn => {
          btn.classList.remove('active');
          if (btn.dataset.view === viewType) {
            btn.classList.add('active');
          }
        });
      }

      applyFilters() {
        if (!window.launchDataManager) return;

        let filteredLaunches = Array.from(launchDataManager.launches.values());

        // Apply agency filter
        if (this.activeFilters.agency !== 'all') {
          filteredLaunches = filteredLaunches.filter(launch => 
            launch.agency === this.activeFilters.agency
          );
        }

        // Apply status filter
        if (this.activeFilters.status !== 'all') {
          if (this.activeFilters.status === 'recent') {
            filteredLaunches = filteredLaunches.filter(launch => 
              ['success', 'failure'].includes(launch.status)
            );
          } else {
            filteredLaunches = filteredLaunches.filter(launch => 
              launch.status === this.activeFilters.status
            );
          }
        }

        // Apply mission type filter
        if (this.activeFilters.missionType !== 'all') {
          filteredLaunches = filteredLaunches.filter(launch => 
            launch.mission?.type === this.activeFilters.missionType ||
            launch.international?.missionType === this.activeFilters.missionType
          );
        }

        // Apply rocket type filter
        if (this.activeFilters.rocketType !== 'all') {
          filteredLaunches = filteredLaunches.filter(launch => 
            launch.rocket?.type === this.activeFilters.rocketType
          );
        }

        // Apply country filter
        if (this.activeFilters.country !== 'all') {
          filteredLaunches = filteredLaunches.filter(launch => 
            launch.international?.agencyCountry === this.activeFilters.country ||
            launch.rocket?.country === this.activeFilters.country
          );
        }

        // Apply search query
        if (this.searchQuery) {
          filteredLaunches = this.performAdvancedSearch(filteredLaunches, this.searchQuery);
        }

        // Apply sorting
        filteredLaunches = this.sortLaunches(filteredLaunches);

        // Apply pagination
        const startIndex = (this.currentPage - 1) * this.resultsPerPage;
        const paginatedLaunches = filteredLaunches.slice(startIndex, startIndex + this.resultsPerPage);

        // Update UI with smooth animations
        this.updateGridWithAnimation(paginatedLaunches);
        this.updateFilterStats(filteredLaunches.length);
        this.updatePagination(filteredLaunches.length);

        console.log(` Applied filters: ${JSON.stringify(this.activeFilters)}, found ${filteredLaunches.length} launches`);
      }

      performAdvancedSearch(launches, query) {
        const searchTerms = query.toLowerCase().split(' ').filter(term => term.length > 0);
        
        return launches.filter(launch => {
          const searchableText = [
            launch.name,
            launch.description,
            launch.rocket?.name,
            launch.rocket?.family,
            launch.payload?.name,
            launch.launchSite?.name,
            launch.launchSite?.location,
            launch.international?.launchProvider,
            launch.mission?.type,
            launch.agency
          ].filter(Boolean).join(' ').toLowerCase();

          // All search terms must be found (AND logic)
          return searchTerms.every(term => searchableText.includes(term));
        });
      }

      sortLaunches(launches) {
        return launches.sort((a, b) => {
          let aValue, bValue;

          switch (this.sortBy) {
            case 'launchTime':
              aValue = new Date(a.schedule.launchTime);
              bValue = new Date(b.schedule.launchTime);
              break;
            case 'name':
              aValue = a.name.toLowerCase();
              bValue = b.name.toLowerCase();
              break;
            case 'agency':
              aValue = a.agency.toLowerCase();
              bValue = b.agency.toLowerCase();
              break;
            case 'rocket':
              aValue = a.rocket?.name?.toLowerCase() || '';
              bValue = b.rocket?.name?.toLowerCase() || '';
              break;
            default:
              return 0;
          }

          if (aValue < bValue) return this.sortOrder === 'asc' ? -1 : 1;
          if (aValue > bValue) return this.sortOrder === 'asc' ? 1 : -1;
          return 0;
        });
      }

      updateGridWithAnimation(launches) {
        const launchGrid = document.getElementById('launch-grid');
        const existingCards = launchGrid.querySelectorAll('.launch-card');

        // Fade out existing cards
        existingCards.forEach((card, index) => {
          setTimeout(() => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
          }, index * 50);
        });

        // Update cards after fade out
        setTimeout(() => {
          launches.forEach((launch, index) => {
            if (index < existingCards.length) {
              updateLaunchCard(existingCards[index], launch);
              existingCards[index].style.display = 'block';
              
              // Fade in updated card
              setTimeout(() => {
                existingCards[index].style.opacity = '1';
                existingCards[index].style.transform = 'translateY(0)';
              }, index * 50);
            }
          });

          // Hide unused cards
          for (let i = launches.length; i < existingCards.length; i++) {
            existingCards[i].style.display = 'none';
          }
        }, this.animationDuration);
      }

      updateFilterStats(totalResults) {
        // Update or create filter stats display
        let statsElement = document.querySelector('.filter-stats');
        if (!statsElement) {
          statsElement = document.createElement('div');
          statsElement.className = 'filter-stats';
          const controlsBar = document.querySelector('.controls-bar');
          if (controlsBar) {
            controlsBar.appendChild(statsElement);
          }
        }

        const activeFilterCount = Object.values(this.activeFilters).filter(f => f !== 'all').length;
        const searchActive = this.searchQuery.length > 0;
        
        let statsText = `${totalResults} launches`;
        if (activeFilterCount > 0 || searchActive) {
          statsText += ` (filtered)`;
        }

        statsElement.textContent = statsText;
      }

      updatePagination(totalResults) {
        const totalPages = Math.ceil(totalResults / this.resultsPerPage);
        
        // Create or update pagination controls
        let paginationElement = document.querySelector('.pagination-controls');
        if (!paginationElement && totalPages > 1) {
          paginationElement = document.createElement('div');
          paginationElement.className = 'pagination-controls';
          
          const launchGrid = document.getElementById('launch-grid');
          if (launchGrid) {
            launchGrid.parentNode.insertBefore(paginationElement, launchGrid.nextSibling);
          }
        }

        if (paginationElement) {
          if (totalPages <= 1) {
            paginationElement.style.display = 'none';
            return;
          }

          paginationElement.style.display = 'flex';
          paginationElement.innerHTML = '';

          // Previous button
          const prevBtn = document.createElement('button');
          prevBtn.className = 'pagination-btn';
          prevBtn.textContent = ' Previous';
          prevBtn.disabled = this.currentPage === 1;
          prevBtn.addEventListener('click', () => this.goToPage(this.currentPage - 1));
          paginationElement.appendChild(prevBtn);

          // Page numbers
          for (let i = 1; i <= Math.min(totalPages, 5); i++) {
            const pageBtn = document.createElement('button');
            pageBtn.className = `pagination-btn ${i === this.currentPage ? 'active' : ''}`;
            pageBtn.textContent = i.toString();
            pageBtn.addEventListener('click', () => this.goToPage(i));
            paginationElement.appendChild(pageBtn);
          }

          // Next button
          const nextBtn = document.createElement('button');
          nextBtn.className = 'pagination-btn';
          nextBtn.textContent = 'Next ';
          nextBtn.disabled = this.currentPage === totalPages;
          nextBtn.addEventListener('click', () => this.goToPage(this.currentPage + 1));
          paginationElement.appendChild(nextBtn);
        }
      }

      goToPage(page) {
        this.currentPage = page;
        this.applyFilters();
        this.updateURL();
      }

      updateURL() {
        const params = new URLSearchParams();
        
        Object.entries(this.activeFilters).forEach(([key, value]) => {
          if (value !== 'all') {
            params.set(key, value);
          }
        });

        if (this.searchQuery) {
          params.set('search', this.searchQuery);
        }

        if (this.sortBy !== 'launchTime' || this.sortOrder !== 'asc') {
          params.set('sort', `${this.sortBy}-${this.sortOrder}`);
        }

        if (this.currentPage > 1) {
          params.set('page', this.currentPage.toString());
        }

        const newURL = params.toString() ? `${window.location.pathname}?${params.toString()}` : window.location.pathname;
        window.history.replaceState({}, '', newURL);
      }

      loadFilterStateFromURL() {
        const params = new URLSearchParams(window.location.search);
        
        // Load filters from URL
        Object.keys(this.activeFilters).forEach(key => {
          const value = params.get(key);
          if (value) {
            this.activeFilters[key] = value;
          }
        });

        // Load search query
        const search = params.get('search');
        if (search) {
          this.searchQuery = search;
          const searchInput = document.getElementById('mission-search');
          if (searchInput) {
            searchInput.value = search;
          }
        }

        // Load sort settings
        const sort = params.get('sort');
        if (sort) {
          const [sortBy, sortOrder] = sort.split('-');
          this.sortBy = sortBy;
          this.sortOrder = sortOrder;
          
          const sortSelect = document.getElementById('sort-select');
          if (sortSelect) {
            sortSelect.value = sort;
          }
        }

        // Load page
        const page = params.get('page');
        if (page) {
          this.currentPage = parseInt(page);
        }

        // Apply loaded state
        this.applyFilters();
      }

      // Public API
      clearAllFilters() {
        this.activeFilters = {
          agency: 'all',
          status: 'all',
          missionType: 'all',
          rocketType: 'all',
          country: 'all'
        };
        this.searchQuery = '';
        this.currentPage = 1;
        
        // Clear UI
        const searchInput = document.getElementById('mission-search');
        if (searchInput) searchInput.value = '';
        
        // Reset filter buttons
        document.querySelectorAll('.filter-btn, .view-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        document.querySelector('[data-filter="all"]')?.classList.add('active');
        document.querySelector('[data-view="upcoming"]')?.classList.add('active');
        
        this.applyFilters();
        this.updateURL();
      }

      getActiveFilters() {
        return { ...this.activeFilters, searchQuery: this.searchQuery };
      }
    }

    // Initialize global filter manager
    const filterManager = new FilterManager();

    // Legacy functions for compatibility
    function applyFilter(filterType) {
      if (window.filterManager) {
        filterManager.setFilter('agency', filterType);
        filterManager.applyFilters();
      }
    }

    function performSearch(query) {
      if (window.filterManager) {
        filterManager.searchQuery = query;
        filterManager.applyFilters();
      }
    }

    function updateGridWithLaunches(launches) {
      const launchGrid = document.getElementById('launch-grid');
      const existingCards = launchGrid.querySelectorAll('.launch-card');
      
      launches.forEach((launch, index) => {
        if (index < existingCards.length) {
          updateLaunchCard(existingCards[index], launch);
          existingCards[index].style.display = 'block';
        }
      });
      
      // Hide unused cards
      for (let i = launches.length; i < existingCards.length; i++) {
        existingCards[i].style.display = 'none';
      }
    }

    // Notification System
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      const colors = {
        success: 'var(--launch-success)',
        info: 'var(--accent)',
        warning: 'var(--launch-delayed)',
        error: 'var(--launch-failure)'
      };
      
      notification.style.cssText = `
        position: fixed;
        top: 120px;
        right: 20px;
        background: ${colors[type] || colors.info};
        color: white;
        padding: 1em 1.5em;
        border-radius: 8px;
        font-size: 0.9em;
        z-index: 10001;
        animation: slideInRight 0.3s ease;
        max-width: 300px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      `;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }

    // Responsive Layout Adjustments
    function handleResponsiveLayout() {
      function adjustLayout() {
        const width = window.innerWidth;
        const launchGrid = document.getElementById('launch-grid');
        
        if (width <= 480) {
          // Mobile layout adjustments
          launchGrid.style.gap = '1em';
        } else if (width <= 768) {
          // Tablet layout adjustments
          launchGrid.style.gap = '1.5em';
        } else {
          // Desktop layout
          launchGrid.style.gap = '2em';
        }
      }

      // Initial adjustment
      adjustLayout();
      
      // Listen for resize events
      window.addEventListener('resize', adjustLayout);
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      updateMoonPhase();
      initializeControls();
      animateSkeletons();
      handleResponsiveLayout();
      
      // Animate statistics after a short delay
      setTimeout(animateStatistics, 500);
      
      // Placeholder countdown animation
      function animatePlaceholderCountdown() {
        const timeUnits = document.querySelectorAll('.next-countdown .time-unit .number');
        timeUnits.forEach((unit, index) => {
          setTimeout(() => {
            unit.style.animation = 'pulse 1s ease-in-out';
            setTimeout(() => {
              unit.style.animation = '';
            }, 1000);
          }, index * 200);
        });
      }

      // Animate placeholder countdown every 5 seconds
      setInterval(animatePlaceholderCountdown, 5000);
      
      // Launch Card Interactions
      initializeLaunchCards();
      
      // Initialize Advanced Systems
      setTimeout(async () => {
        // Initialize Countdown System
        countdownManager.init();
        window.countdownManagerInitialized = true;
        console.log(' Advanced Countdown System Initialized');
        
        // Initialize Launch Data Manager
        await launchDataManager.init();
        console.log(' Launch Data Manager Initialized');
        
        // Initialize Filter Manager
        filterManager.init();
        console.log(' Advanced Filter Manager Initialized');
        
        // Make managers globally available
        window.countdownManager = countdownManager;
        window.launchDataManager = launchDataManager;
        window.filterManager = filterManager;
        
        // Update UI with real data
        updateLaunchGrid();
        updateDashboardStats();
        
        // Show initialization notification
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 100px;
          right: 20px;
          background: var(--launch-success);
          color: white;
          padding: 1em 1.5em;
          border-radius: 8px;
          font-size: 0.9em;
          z-index: 10000;
          animation: slideInRight 0.3s ease;
        `;
        notification.textContent = ' Launch Data System Active!';
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOutRight 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }, 4000);
      }, 1000);
    });
  </script>
</body>
</html>